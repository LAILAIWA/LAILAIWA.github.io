<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/gamepad playstation.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/Dig Dug.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/gamepad playstation.png?v=5.1.4">


  <link rel="mask-icon" href="/images/gamepad playstation.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="git,">





  <link rel="alternate" href="/atom.xml" title="俺的部落格" type="application/atom+xml">






<meta name="description" content="简单整理Git相关内容和操作，内容来源于：廖雪峰的官方网站">
<meta name="keywords" content="git">
<meta property="og:type" content="article">
<meta property="og:title" content="Git &lt;整&gt;">
<meta property="og:url" content="http://linyishui.top/2019090501.html">
<meta property="og:site_name" content="俺的部落格">
<meta property="og:description" content="简单整理Git相关内容和操作，内容来源于：廖雪峰的官方网站">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20190801/201908010103.png">
<meta property="og:updated_time" content="2019-10-21T10:08:04.409Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Git &lt;整&gt;">
<meta name="twitter:description" content="简单整理Git相关内容和操作，内容来源于：廖雪峰的官方网站">
<meta name="twitter:image" content="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20190801/201908010103.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://linyishui.top/2019090501.html">





  <title>Git <整> | 俺的部落格</整></title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">俺的部落格</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">俺寻思俺需要记点东西</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://linyishui.top/2019090501.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="林沂水">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/riho_yoshioka1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="俺的部落格">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Git <整></整></h1>
        

        <div class="post-meta">
          
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-05T17:13:47+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文档/" itemprop="url" rel="index">
                    <span itemprop="name">技术文档</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,999
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  33
                </span>
              
            </div>
          

          
              <div class="post-description">
                  简单整理Git相关内容和操作，内容来源于：廖雪峰的官方网站
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&emsp;&emsp;<em>内容主要整理自<a href="https://www.liaoxuefeng.com/wiki/896043488029600" title="Title" target="_blank" rel="noopener">廖雪峰的官方网站</a>，如果读后有收获可以去链接网站扫码打赏支持一下。</em></p>
<h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a><strong>Git</strong></h1><h2 id="第一节-什么是Git"><a href="#第一节-什么是Git" class="headerlink" title="第一节 什么是Git"></a><strong>第一节 什么是Git</strong></h2><p>&emsp;&emsp;Git是一款开源的分布式版本控制系统。分布式即多人多用户，通过拷贝镜像的方式运转，版本控制即对项目的历史版本记录。Git最早来源于Linux的作者Linus，通过C语言开发，后来的GitHub则专门为开源项目提供免费的Git存储服务。</p>
<p>&emsp;&emsp;CVS和SVN都是集中式的版本控制系统。</p>
<blockquote>
<p>集中式和分布式的区别：</p>
<p>&emsp;&emsp;集中式的版本库存放于中央服务器，开发者需要从服务器获取最新版本，然后将更新内容发送给服务器。所以集中式要求必须要在联网环境下才能工作。分布式系统则没有中央服务器，每台用户电脑都有完整的版本库，所以不需要联网环境，在修改时把各自修改的内容互相推送来进行协作。通常会有一台机器充当”中央服务器”，方便记录所有人的修改。</p>
</blockquote>
<hr>
<h2 id="第二节-安装"><a href="#第二节-安装" class="headerlink" title="第二节 安装"></a><strong>第二节 安装</strong></h2><p>&emsp;&emsp;根据自己的操作系统(Linux，Unix，Mac，Windows等)进行安装，具体过程不贴，网上可以随处找到。</p>
<hr>
<h2 id="第三节-版本库"><a href="#第三节-版本库" class="headerlink" title="第三节 版本库"></a><strong>第三节 版本库</strong></h2><p>&emsp;&emsp;<strong>版本库</strong>(repository)，即项目仓库。可以理解为一个盒子或者目录，里面所有文件都会被Git管理，所以每个文件的各种操作都会被记录下来，可以随时追踪其历史，并还原某个时间点所处的状态。</p>
<h3 id="添加、提交、查看"><a href="#添加、提交、查看" class="headerlink" title="添加、提交、查看"></a><strong>添加、提交、查看</strong></h3><blockquote>
<p>git init </p>
</blockquote>
<p>&emsp;&emsp;此命令可以把当前目录作为Git可以管理的仓库。执行后会多出.git目录，用来跟踪管理版本库，默认隐藏。</p>
<p>&emsp;&emsp;所有的版本控制系统只能跟踪文本文件的改动，如txt，html，java等，可以记录文件中所有文本的变动。但对于图片和视频这些二进制文件，系统无法记录具体的变化(Word文件是二进制格式，所以无法跟踪其文本变更)。</p>
<blockquote>
<p>git add readme.txt</p>
</blockquote>
<p>&emsp;&emsp;在目录下创建readme文件，然后执行上述命令，告诉Git将文件添加到仓库。</p>
<blockquote>
<p>git commit -m “add a new txt”</p>
</blockquote>
<p>&emsp;&emsp;通过git commit指令告诉Git，把文件提交给仓库。-m后跟提交说明，可多次add添加，一次统一提交commit。</p>
<blockquote>
<p>git status</p>
</blockquote>
<p>&emsp;&emsp;修改readme文件内容，再执行上述指令，返回信息表示文件已修改但未提交</p>
<p>&emsp;&emsp;再一次执行git add，然后git status，发现返回信息更新，表示文件准备提交，最后git commit。然后git status，发现目录没有需要提交的文件。</p>
<blockquote>
<p>git diff</p>
</blockquote>
<p>&emsp;&emsp;如果文件修改，可以通过上述指令查看修改内容。</p>
<h3 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a><strong>版本回退</strong></h3><blockquote>
<p>git log</p>
</blockquote>
<p>&emsp;&emsp;通过上述指令，可以查看操作日志，</p>
<blockquote>
<p>git reset –hard HEAD^</p>
</blockquote>
<blockquote>
<p>git reset –hard 1094a</p>
</blockquote>
<p>&emsp;&emsp;git reset指令回退目录到指定版本，版本号不需要输入完整，Git会自动查询匹配</p>
<blockquote>
<p>git reflog</p>
</blockquote>
<p>&emsp;&emsp;可以通过git reflog指令查看每次操作，而回退版本只是修改当前版本为旧版本，并更新文件，但不会影响被覆盖的版本，仍可以随时切换回。</p>
<hr>
<h2 id="第四节-工作区和暂存区"><a href="#第四节-工作区和暂存区" class="headerlink" title="第四节 工作区和暂存区"></a><strong>第四节 工作区和暂存区</strong></h2><p>&emsp;&emsp;工作区就是开发人员PC中可以看到的文件目录，工作区有一个隐藏目录.git，是Git的<strong>版本库</strong>。</p>
<p>&emsp;&emsp;版本库内有一块<strong>暂存区</strong>state，git add指令就是将文件修改添加到暂存区。而git commit则是将暂存区内容提交到当前分支。Git会默认自动创建一个master分支，所以此时会将修改内容提交到master分支。</p>
<h3 id="文件修改"><a href="#文件修改" class="headerlink" title="文件修改"></a><strong>文件修改</strong></h3><p>&emsp;&emsp;Git专注于修改而不是文件，可以通过以下案例来了解相关内容。</p>
<p>&emsp;&emsp;尝试执行以下指令顺序。</p>
<blockquote>
<ol>
<li>修改文件</li>
<li>git add xx</li>
<li>git status</li>
<li>再修改文件</li>
<li>git commit -m “git tracks changes”</li>
<li>git status</li>
</ol>
</blockquote>
<p>&emsp;&emsp;会发现后一次修改并未提交，信息如下。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for <span class="keyword">commit</span>:</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git add &lt;file&gt;..."</span> <span class="keyword">to</span> <span class="keyword">update</span> what will be committed)</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git checkout -- &lt;file&gt;..."</span> <span class="keyword">to</span> discard changes <span class="keyword">in</span> working <span class="keyword">directory</span>)</span><br><span class="line"></span><br><span class="line">        modified:   t.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">no</span> changes added <span class="keyword">to</span> <span class="keyword">commit</span> (<span class="keyword">use</span> <span class="string">"git add"</span> <span class="keyword">and</span>/<span class="keyword">or</span> <span class="string">"git commit -a"</span>)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;原因是在第一次修改后，执行了git add到暂存区，然后再进行二次修改，再提交时把暂存区内容提交，但二次修改还未加入暂存区。所以修改后必须要先add再提交才会有效果。</p>
<h3 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a><strong>撤销修改</strong></h3><blockquote>
<ol>
<li>修改文件，添加一行文字</li>
<li>add，commit</li>
<li>删除此行</li>
<li>git status</li>
</ol>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">On branch master</span><br><span class="line">Changes not staged for <span class="keyword">commit</span>:</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git add &lt;file&gt;..."</span> <span class="keyword">to</span> <span class="keyword">update</span> what will be committed)</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git checkout -- &lt;file&gt;..."</span> <span class="keyword">to</span> discard changes <span class="keyword">in</span> working <span class="keyword">directory</span>)</span><br><span class="line"></span><br><span class="line">        modified:   t.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">no</span> changes added <span class="keyword">to</span> <span class="keyword">commit</span> (<span class="keyword">use</span> <span class="string">"git add"</span> <span class="keyword">and</span>/<span class="keyword">or</span> <span class="string">"git commit -a"</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>git checkout – <file></file></p>
</blockquote>
<p>&emsp;&emsp;git checkout指令表示可以撤销修改，分为两种情况：1.文件修改后还未add到暂存区，撤销后就和版本库一致。2.文件已添加到暂存区，又做了修改，撤销修改就回到add后的状态。总之就是让此文件回到最近一次commit或add的状态。</p>
<blockquote>
<p>git reset HEAD <file></file></p>
</blockquote>
<p>&emsp;&emsp;通过此指令可以把暂存区的修改撤销，重新放回工作区。</p>
<p>&emsp;&emsp;如果想回退已经commit的修改，则需要通过前文的版本回退。</p>
<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a><strong>删除文件</strong></h3><p>&emsp;&emsp;先删除文件，再git status。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for <span class="keyword">commit</span>:</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git add/rm &lt;file&gt;..."</span> <span class="keyword">to</span> <span class="keyword">update</span> what will be committed)</span><br><span class="line">  (<span class="keyword">use</span> <span class="string">"git checkout -- &lt;file&gt;..."</span> <span class="keyword">to</span> discard changes <span class="keyword">in</span> working <span class="keyword">directory</span>)</span><br><span class="line"></span><br><span class="line">        deleted:    t.txt</span><br><span class="line"></span><br><span class="line"><span class="keyword">no</span> changes added <span class="keyword">to</span> <span class="keyword">commit</span> (<span class="keyword">use</span> <span class="string">"git add"</span> <span class="keyword">and</span>/<span class="keyword">or</span> <span class="string">"git commit -a"</span>)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Git发现文件被删除，所以我们通过rm删除，并commit，使文件从版本库也删除。</p>
<blockquote>
<p>git rm <file></file></p>
</blockquote>
<p>&emsp;&emsp;还有可能删除了，可以通过checkout恢复。</p>
<hr>
<h2 id="第五节-远程仓库"><a href="#第五节-远程仓库" class="headerlink" title="第五节 远程仓库"></a><strong>第五节 远程仓库</strong></h2><p>&emsp;&emsp;实际开发中，我们需要一台服务器作为远程仓库来备份版本库以及作为用户的协调中枢。而GitHub就是提供Git仓库托管服务的网站。</p>
<p>&emsp;&emsp;注册账号过程跳过。本地Git仓库和GitHub远程仓库是通过SSH加密传输的，所以需要配置密钥。</p>
<blockquote>
<p>$ ssh-keygen -t rsa -C “<a href="mailto:youremail@example.com" target="_blank" rel="noopener">youremail@example.com</a>“</p>
</blockquote>
<p>&emsp;&emsp;可以通过上述命令创建SSH Key，然后在用户文档，找到.ssh目录，会有id_rsa和id_rsa.pub两个文件，即SSH Key的密钥对，pub表示公钥。然后在github网站配置SSH Keys。</p>
<p>&emsp;&emsp;然后可以在GitHub上创建一个远程仓库。然后复制SSH地址：Clone with SSH</p>
<blockquote>
<p>$ git remote add origin <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:xx1/xx2</p>
</blockquote>
<p>&emsp;&emsp;通过此命令可以关联本地仓库和远程仓库，xx1是用户名，xx2为项目名。Git默认会给远程库起名origin。</p>
<blockquote>
<p>$ git push -u origin master</p>
</blockquote>
<blockquote>
<p>$ git push origin master</p>
</blockquote>
<p>&emsp;&emsp;通过此命令把本地库所有内容推送到远程库。由于远程库是空的，所以首次推送添加了-u参数，Git不但会把本地master分支内容推送到远程新的master分支，还会将他们关联，以后的推送或拉取就可以简化命令。</p>
<blockquote>
<p>$ git clone <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:xx1/xx2</p>
</blockquote>
<p>&emsp;&emsp;上面是先有本地库再开启远程库，此命令则是先有远程库时克隆其内容到本地。</p>
<hr>
<h2 id="第六节-分支管理"><a href="#第六节-分支管理" class="headerlink" title="第六节 分支管理"></a><strong>第六节 分支管理</strong></h2><p>&emsp;&emsp;Git的分支管理要远远优秀于SVN。</p>
<p><img src="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20190801/201908010103.png" alt="Git分支图"></p>
<p>&emsp;&emsp;master分支即主分支，可以把Head看作指针，HEAD指向当前分支，而分支则指向提交。每个点就是一次提交，所以每次commit就会推动分支前进一步。新的分支则处在一条新的时间线，在平时各个分支间没有任何关系。</p>
<h3 id="创建与合并分支"><a href="#创建与合并分支" class="headerlink" title="创建与合并分支"></a><strong>创建与合并分支</strong></h3><p>&emsp;&emsp;Git创建分支效率很高，创建新的分支指针，再更新HEAD的指向即可。当一个分支上任务结束，则需要合并到主分支上，合并就是matser直接指向当前提交，就完成了合并工作。合并之后可以删除没用的分支。</p>
<blockquote>
<p>$ git checkout -b dev</p>
</blockquote>
<blockquote>
<p>$ git branch dev</p>
<p>$ git checkout dev</p>
</blockquote>
<p>&emsp;&emsp;创建并切换到dev分支，-b参数表示创建并切换，等价于后两条指令。</p>
<blockquote>
<p>$ git branch</p>
</blockquote>
<p>&emsp;&emsp;查看当前分支。</p>
<blockquote>
<p>$ git checkout master</p>
</blockquote>
<p>&emsp;&emsp;切换回master分支。</p>
<blockquote>
<p>$ git merge dev</p>
</blockquote>
<p>&emsp;&emsp;合并指定分支到当前分支。</p>
<blockquote>
<p>$ git branch -d dev</p>
</blockquote>
<p>&emsp;&emsp;合并后删除分支。</p>
<blockquote>
<p>$ git switch -c dev</p>
<p>$ git switch matser</p>
</blockquote>
<p>&emsp;&emsp;新版本推荐用switch指令代替checkout来进行切换，后者容易和撤销修改搞混。-c参数表示创建。</p>
<h3 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a><strong>解决冲突</strong></h3><blockquote>
<ol>
<li>创建新分支：$ git switch -c feature1</li>
<li>修改文件内容。</li>
<li>提交修改到分支：$ git add x.txt  $ git commit -m “feature1 submit”</li>
<li>切换到master分支(Git提醒当前master分支比origin/master分支超前)：$ git switch master</li>
<li>在修改文件上新增内容。</li>
<li>提交：$ git add x.txt $ git commit -m “master submit”</li>
<li>执行合并分支请求：$ git merge feature1</li>
</ol>
</blockquote>
<p>&emsp;&emsp;结果Git提示发生冲突，可以通过git status查看冲突文件，也可以直接查看冲突文件。修改文件内容，再提交解决冲突部分。可以删除分支feature1了。</p>
<h3 id="分支管理策略"><a href="#分支管理策略" class="headerlink" title="分支管理策略"></a><strong>分支管理策略</strong></h3><p>&emsp;&emsp;通常情况下，合并分支是fast forward模式，但此模式删除分支会失去分支信息。如果禁用fast forward模式，Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。</p>
<blockquote>
<p>$ git switch -c dev</p>
</blockquote>
<p>&emsp;&emsp;创建并切换dev分支</p>
<blockquote>
<p>$ git add readme.txt </p>
<p>$ git commit -m “add merge”</p>
</blockquote>
<p>&emsp;&emsp;修改readme.txt，并提交。</p>
<blockquote>
<p>$ git switch matser</p>
</blockquote>
<p>&emsp;&emsp;切回master</p>
<blockquote>
<p>$ git merge –no-ff -m “merge with no-ff” dev</p>
</blockquote>
<p>&emsp;&emsp;合并dev分支，–no-ff参数，表示禁用Fast forward</p>
<blockquote>
<p>$ git log</p>
</blockquote>
<p>&emsp;&emsp;合并后，用git log看看分支历史</p>
<p>&emsp;&emsp;在实际开发中，master分支应该仅用来发布新版本，不能直接在上面干活；干活都在dev分支上，也就是说，dev分支是不稳定的，到某个时候，比如1.0版本发布时，再把dev分支合并到master上，在master分支发布1.0版本。</p>
<h3 id="Bug分支"><a href="#Bug分支" class="headerlink" title="Bug分支"></a><strong>Bug分支</strong></h3><p>&emsp;&emsp;在Git创建和删除分支是比较简洁的操作，所以每个bug都可以通过一个新的临时分支来修复，修复后再合并分支，然后将临时分支删除。</p>
<p>&emsp;&emsp;假定一个工作场景：你接到一个编号101的bug修复任务，很自然地你想创建一个分支issue-101来修复它，但是当前正在dev上进行的工作还没有提交。</p>
<blockquote>
<p>$ git status</p>
</blockquote>
<p>&emsp;&emsp;预计完成还需1天时间。但是必须在两个小时内修复该bug，怎么办？幸好，Git还提供了一个stash功能，可以把当前工作现场“储藏”起来，等以后恢复现场后继续工作。</p>
<blockquote>
<p>$ git stash</p>
</blockquote>
<p>&emsp;&emsp;现在用git status查看工作区，就是干净的（除非有没有被Git管理的文件），因此可以放心地创建分支来修复bug。</p>
<p>&emsp;&emsp;首先确定要在哪个分支上修复bug，假定需要在master分支上修复，就从master创建临时分支。</p>
<blockquote>
<p>$ git switch master</p>
<p>$ git switch -c issue-101</p>
</blockquote>
<p>&emsp;&emsp;然后修复bug，提交。</p>
<blockquote>
<p>$ git add readme.txt </p>
<p>$ git commit -m “fix bug 101”</p>
</blockquote>
<p>&emsp;&emsp;修复完成后，切换到master分支，并完成合并，最后删除issue-101分支。</p>
<blockquote>
<p>$ git switch master</p>
<p>$ git merge –no-ff -m “merged bug fix 101” issue-101</p>
</blockquote>
<p>&emsp;&emsp;回到dev分支继续工作。</p>
<blockquote>
<p>$ git switch dev</p>
<p>$ git status</p>
</blockquote>
<p>&emsp;&emsp;通过git stash list查看之前保存的工作现场</p>
<blockquote>
<p>$ git stash list</p>
</blockquote>
<p>&emsp;&emsp;找到工作现场后，就要恢复工作现场。一是用git stash apply恢复，但是恢复后stash内容并不删除，需要用git stash drop来删除；另一种方式是用git stash pop，恢复的同时把stash内容也删了。</p>
<blockquote>
<p>$ git stash pop</p>
<p>$ git stash list</p>
</blockquote>
<p>&emsp;&emsp;如果保存了多次现场，可以指定恢复。</p>
<blockquote>
<p>$ git stash apply stash@{0}</p>
</blockquote>
<p>&emsp;&emsp;修改BUG是在master上开分支最后合并的，那么当前dev分支一定还存在相同BUG，为了方便操作，Git专门提供了一个cherry-pick命令，让我们能复制一个特定的提交到当前分支。</p>
<blockquote>
<p>$ git branch</p>
<p>$ git cherry-pick 4c805e2</p>
</blockquote>
<p>&emsp;&emsp;复制提交：4c805e2 fix bug 101。Git自动给dev分支做了一次提交，注意这次提交的commit是1d4b803，它并不同于master的4c805e2，因为这两个commit只是改动相同，但确实是两个不同的commit。用git cherry-pick，我们就不需要在dev分支上手动再把修bug的过程重复一遍。</p>
<p>&emsp;&emsp;既然可以在master分支上修复bug后，在dev分支上可以“重放”这个修复过程，那么直接在dev分支上修复bug，然后在master分支上“重放”行不行？当然可以，不过你仍然需要git stash命令保存现场，才能从dev分支切换到master分支。</p>
<h3 id="Feature分支"><a href="#Feature分支" class="headerlink" title="Feature分支"></a><strong>Feature分支</strong></h3><p>&emsp;&emsp;添加一个新功能时，你肯定不希望因为一些实验性质的代码，把主分支搞乱了，所以每添加一个新功能，最好新建一个feature分支，在上面进行开发，完成后再合并，最后删除该feature分支。</p>
<p>&emsp;&emsp;假设我们收到了一个开发任务：开发代号为Vulcan的新功能，该功能计划用于下一代星际飞船。</p>
<blockquote>
<p>$ git switch -c feature-vulcan</p>
</blockquote>
<p>&emsp;&emsp;开发完毕，提交。</p>
<blockquote>
<p>$ git add vulcan.py</p>
<p>$ git status</p>
<p>$ git commit -m “add feature vulcan”</p>
</blockquote>
<p>&emsp;&emsp;切回dev，准备合并。</p>
<blockquote>
<p>$ git switch dev</p>
</blockquote>
<p>&emsp;&emsp;正常流程，合并成功然后删除。但是有些特殊情况，比如上级命令因经费不足，新功能必须取消。虽然白干了，但是这个包含机密资料的分支还是必须就地销毁。</p>
<blockquote>
<p>$ git branch -d feature-vulcan</p>
</blockquote>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">error: </span>The branch 'feature-vulcan' is not fully merged.</span><br><span class="line">If you are sure you want to delete it, run 'git branch -D feature-vulcan'.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;销毁失败。Git友情提醒，feature-vulcan分支还没有被合并，如果删除，将丢失掉修改，如果要强行删除，需要使用大写的-D参数。。</p>
<p>&emsp;&emsp;强行删除。</p>
<blockquote>
<p>$ git branch -D feature-vulcan</p>
</blockquote>
<h3 id="多人协作"><a href="#多人协作" class="headerlink" title="多人协作"></a><strong>多人协作</strong></h3><p>&emsp;&emsp;当从远程仓库克隆时，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且远程仓库的默认名称是origin。</p>
<p>&emsp;&emsp;要查看远程库的信息，就用git remote，或者用git remote -v显示更详细的信息，上面显示了可以抓取和推送的origin的地址。如果没有推送权限，就看不到push的地址。</p>
<blockquote>
<p>$ git remote</p>
</blockquote>
<h4 id="推送分支"><a href="#推送分支" class="headerlink" title="推送分支"></a><strong>推送分支</strong></h4><p>&emsp;&emsp;<strong>推送分支</strong>就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样Git就会把该分支推送到远程库对应的远程分支上。</p>
<blockquote>
<p>$ git push origin master</p>
</blockquote>
<p>&emsp;&emsp;如果要推送其他分支，比如dev，就改成。</p>
<blockquote>
<p>$ git push origin dev</p>
</blockquote>
<p>&emsp;&emsp;但是，并不是一定要把本地分支往远程推送，那么，哪些分支需要推送，哪些不需要呢？</p>
<ul>
<li><p>master分支是主分支，因此要时刻与远程同步；</p>
</li>
<li><p>dev分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；</p>
</li>
<li><p>bug分支只用于在本地修复bug，就没必要推到远程了，除非老板要看看你每周到底修复了几个bug；</p>
</li>
<li><p>feature分支是否推到远程，取决于你是否和你的小伙伴合作在上面开发。</p>
</li>
</ul>
<h4 id="抓取分支"><a href="#抓取分支" class="headerlink" title="抓取分支"></a><strong>抓取分支</strong></h4><p>&emsp;&emsp;多人协作时，大家都会往master和dev分支上推送各自的修改。</p>
<blockquote>
<p>$ git clone <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:xx/xx</p>
</blockquote>
<p>&emsp;&emsp;当团队成员从远程库clone时，默认情况下，他只能看到本地的master分支，可以用git branch命令看看。</p>
<blockquote>
<p>$ git branch</p>
</blockquote>
<p>&emsp;&emsp;当成员需要在dev分支上开发，就必须创建远程origin的dev分支到本地，于是他用这个命令创建本地dev分支。</p>
<blockquote>
<p>$ git switch -c dev origin/dev</p>
</blockquote>
<p>&emsp;&emsp;现在，他就可以在dev上继续修改，然后时不时地把dev分支push到远程：</p>
<blockquote>
<p>$ git add env.txt</p>
<p>$ git commit -m “add env”</p>
<p>$ git push origin dev</p>
</blockquote>
<h4 id="解决冲突-1"><a href="#解决冲突-1" class="headerlink" title="解决冲突"></a><strong>解决冲突</strong></h4><p>&emsp;&emsp;其他成员已经向origin/dev分支推送了他的提交，可能碰巧你也对同样的文件作了修改，并试图推送。</p>
<blockquote>
<p>$ git add env.txt</p>
<p>$ git commit -m “add new env”</p>
<p>$ git push origin dev</p>
</blockquote>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">To github.<span class="keyword">com</span>:xx/xx</span><br><span class="line"> ! [rejected]        dev -&gt; dev (non-fast-forward)</span><br><span class="line">error: failed <span class="keyword">to</span> push some refs <span class="keyword">to</span> <span class="string">'git@github.com:xx/xx'</span></span><br><span class="line">hin<span class="variable">t:</span> Updates were rejected because the tip of your current branch <span class="keyword">is</span> behind</span><br><span class="line">hin<span class="variable">t:</span> its remote counterpart. Integrate the remote <span class="keyword">changes</span> (<span class="keyword">e</span>.g.</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">'git pull ...'</span>) before pushing again.</span><br><span class="line">hin<span class="variable">t:</span> See the <span class="string">'Note about fast-forwards'</span> in <span class="string">'git push --help'</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;推送失败，因为他人的最新提交和你试图推送的提交有冲突，解决办法也很简单，Git已经提示我们，先用git pull把最新的提交从origin/dev抓下来，然后，在本地合并，解决冲突，再推送。</p>
<blockquote>
<p>$ git pull</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">There is <span class="literal">no</span><span class="built_in"> tracking </span>information <span class="keyword">for</span> the current branch.</span><br><span class="line">Please specify which branch you want <span class="keyword">to</span> merge with.</span><br><span class="line">See git-pull(1) <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">    git pull &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> you wish <span class="keyword">to</span> <span class="builtin-name">set</span><span class="built_in"> tracking </span>information <span class="keyword">for</span> this branch you can <span class="keyword">do</span> so with:</span><br><span class="line"></span><br><span class="line">    git branch <span class="attribute">--set-upstream-to</span>=origin/&lt;branch&gt; dev</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;git pull也失败了，原因是没有指定本地dev分支与远程origin/dev分支的链接，根据提示设置dev和origin/dev的链接。</p>
<blockquote>
<p>$ git branch –set-upstream-to=origin/dev dev</p>
</blockquote>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Branch <span class="string">'dev'</span> <span class="built_in">set</span> up <span class="built_in">to</span> track remote branch <span class="string">'dev'</span> <span class="built_in">from</span> <span class="string">'origin'</span>.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;再pull。</p>
<blockquote>
<p>$ git pull</p>
</blockquote>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Auto-merging env.txt</span><br><span class="line">CONFLICT (<span class="built_in">add</span>/<span class="built_in">add</span>): Merge conflict <span class="keyword">in</span> env.txt</span><br><span class="line">Automatic <span class="built_in">merge</span> failed; fix conflicts <span class="keyword">and</span> <span class="keyword">then</span> commit <span class="keyword">the</span> <span class="built_in">result</span>.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这回git pull成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的解决冲突完全一样。解决后提交，再push：</p>
<blockquote>
<p>$ git commit -m “fix env conflict”</p>
<p>$ git push origin dev</p>
</blockquote>
<h3 id="Rebase"><a href="#Rebase" class="headerlink" title="Rebase"></a><strong>Rebase</strong></h3><p>&emsp;&emsp;多人在同一个分支上协作时，很容易出现冲突。即使没有冲突，后push的开发人员不得不先pull，在本地合并，然后才能push成功。</p>
<p>&emsp;&emsp;所以每次合并再push后，分支变成了这样。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ git log --graph --pretty=oneline --abbrev-commit</span><br><span class="line"></span><br><span class="line"><span class="symbol">*</span> d1be385 (HEAD -&gt; master, origin/master) init hello</span><br><span class="line"><span class="symbol">*</span>   e5e69f1 Merge branch 'dev'</span><br><span class="line">|<span class="string">\  </span></span><br><span class="line">|<span class="string"> *   57c53ab (origin/dev, dev) fix env conflict</span></span><br><span class="line">|<span class="string"> </span>|<span class="string">\  </span></span><br><span class="line">|<span class="string"> </span>|<span class="string"> * 7a5e5dd add env</span></span><br><span class="line">|<span class="string"> * </span>|<span class="string"> 7bd91f1 add new env</span></span><br><span class="line">|<span class="string"> </span>|<span class="string">/  </span></span><br><span class="line"><span class="string">* </span>|<span class="string">   12a631b merged bug fix 101</span></span><br><span class="line">|<span class="string">\ \  </span></span><br><span class="line">|<span class="string"> * </span>|<span class="string"> 4c805e2 fix bug 101</span></span><br><span class="line">|<span class="string">/ /  </span></span><br><span class="line"><span class="string">* </span>|<span class="string">   e1e9c68 merge with no-ff</span></span><br><span class="line">|<span class="string">\ \  </span></span><br><span class="line">|<span class="string"> </span>|<span class="string">/  </span></span><br><span class="line">|<span class="string"> * f52c633 add merge</span></span><br><span class="line">|<span class="string">/  </span></span><br><span class="line"><span class="string">*   cf810e4 conflict fixed</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;看上去很乱，Git的提交历史可以是一条干净的直线吗？Git有一种称为rebase的操作，有人把它翻译成“变基”。</p>
<p>&emsp;&emsp;在和远程分支同步后，我们对hello.py这个文件做了两次提交。用git log命令看看：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git log --graph --pretty=oneline --abbrev-commit</span><br><span class="line"></span><br><span class="line">* <span class="number">582</span>d922 (HEAD -&gt; master) <span class="keyword">add</span><span class="bash"> author</span></span><br><span class="line"><span class="bash">* 8875536 add comment</span></span><br><span class="line"><span class="bash">* d1be385 (origin/master) init hello</span></span><br><span class="line"><span class="bash">*   e5e69f1 Merge branch <span class="string">'dev'</span></span></span><br><span class="line"><span class="bash">|\  </span></span><br><span class="line"><span class="bash">| *   57c53ab (origin/dev, dev) fix env conflict</span></span><br><span class="line"><span class="bash">| |\  </span></span><br><span class="line"><span class="bash">| | * 7a5e5dd add env</span></span><br><span class="line"><span class="bash">| * | 7bd91f1 add new env</span></span><br><span class="line"><span class="bash">...</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;注意到Git用(HEAD -&gt; master)和(origin/master)标识出当前分支的HEAD和远程origin的位置分别是582d922 add author和d1be385 init hello，本地分支比远程分支快两个提交。</p>
<p>&emsp;&emsp;现在我们尝试推送本地分支。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin master</span><br><span class="line"></span><br><span class="line">To github.com:xx/xx</span><br><span class="line"> ! [rejected]        master -&gt; master (fetch <span class="keyword">first</span>)</span><br><span class="line">error: failed <span class="built_in">to</span> push some refs <span class="built_in">to</span> <span class="string">'git@github.com:xx/xx'</span></span><br><span class="line">hint: Updates were rejected because <span class="keyword">the</span> remote <span class="keyword">contains</span> work that you <span class="built_in">do</span></span><br><span class="line">hint: <span class="keyword">not</span> have locally. This is usually caused <span class="keyword">by</span> another repository pushing</span><br><span class="line">hint: <span class="built_in">to</span> <span class="keyword">the</span> same ref. You may want <span class="built_in">to</span> <span class="keyword">first</span> integrate <span class="keyword">the</span> remote changes</span><br><span class="line">hint: (e.g., <span class="string">'git pull ...'</span>) <span class="keyword">before</span> pushing again.</span><br><span class="line">hint: See <span class="keyword">the</span> <span class="string">'Note about fast-forwards'</span> <span class="keyword">in</span> <span class="string">'git push --help'</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;很不幸失败了，这说明有人先于我们推送了远程分支。按照经验，先pull一下。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git pull</span><br><span class="line"></span><br><span class="line">remote: Counting object<span class="variable">s:</span> <span class="number">3</span>, done.</span><br><span class="line">remote: Compressing object<span class="variable">s:</span> <span class="number">100</span>% (<span class="number">1</span>/<span class="number">1</span>), done.</span><br><span class="line">remote: Total <span class="number">3</span> (delta <span class="number">1</span>), reused <span class="number">3</span> (delta <span class="number">1</span>), pack-reused <span class="number">0</span></span><br><span class="line">Unpacking object<span class="variable">s:</span> <span class="number">100</span>% (<span class="number">3</span>/<span class="number">3</span>), done.</span><br><span class="line">From github.<span class="keyword">com</span>:xx/xx</span><br><span class="line">   d1be385..f005ed4  master     -&gt; origin/master</span><br><span class="line"> * [<span class="keyword">new</span> <span class="keyword">tag</span>]         v1.<span class="number">0</span>       -&gt; v1.<span class="number">0</span></span><br><span class="line">Auto-merging hello.<span class="keyword">py</span></span><br><span class="line">Merge made by the <span class="string">'recursive'</span> strategy.</span><br><span class="line"> hello.<span class="keyword">py</span> | <span class="number">1</span> +</span><br><span class="line"> <span class="number">1</span> <span class="keyword">file</span> changed, <span class="number">1</span> insertion(+)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;再用git status看看状态。</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> branch master</span><br><span class="line">Your branch <span class="keyword">is</span> ahead <span class="keyword">of</span> <span class="comment">'origin/master' by 3 commits.</span></span><br><span class="line">  (use <span class="string">"git push"</span> <span class="keyword">to</span> publish your local commits)</span><br><span class="line"></span><br><span class="line"><span class="literal">nothing</span> <span class="keyword">to</span> commit, working tree clean</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;加上刚才合并的提交，现在我们本地分支比远程分支超前3个提交。用git log看看。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> <span class="comment">--graph --pretty=oneline --abbrev-commit</span></span><br><span class="line"></span><br><span class="line">*   e0ea545 (HEAD -&gt; master) Merge branch <span class="string">'master'</span> <span class="keyword">of</span> github.com:xx/xx</span><br><span class="line">|\  </span><br><span class="line">| * f005ed4 (origin/master) <span class="built_in">set</span> exit=<span class="number">1</span></span><br><span class="line">* | <span class="number">582</span>d922 <span class="built_in">add</span> author</span><br><span class="line">* | <span class="number">8875536</span> <span class="built_in">add</span> comment</span><br><span class="line">|/  </span><br><span class="line">* d1be385 init hello</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;现在的状况就是提交历史分叉了，如果现在把本地分支push到远程，也是正确的，但对于一些人来说会觉得有些影响阅读。这个时候，rebase就派上了用场。我们输入命令git rebase试试。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git rebase</span><br><span class="line"></span><br><span class="line">First, rewinding head <span class="keyword">to</span> replay your work on top of it<span class="built_in">..</span>.</span><br><span class="line">Applying: <span class="builtin-name">add</span> comment</span><br><span class="line">Using index <span class="builtin-name">info</span> <span class="keyword">to</span> reconstruct a base tree<span class="built_in">..</span>.</span><br><span class="line">M	hello.py</span><br><span class="line">Falling back <span class="keyword">to</span> patching base <span class="keyword">and</span> 3-way merge<span class="built_in">..</span>.</span><br><span class="line">Auto-merging hello.py</span><br><span class="line">Applying: <span class="builtin-name">add</span> author</span><br><span class="line">Using index <span class="builtin-name">info</span> <span class="keyword">to</span> reconstruct a base tree<span class="built_in">..</span>.</span><br><span class="line">M	hello.py</span><br><span class="line">Falling back <span class="keyword">to</span> patching base <span class="keyword">and</span> 3-way merge<span class="built_in">..</span>.</span><br><span class="line">Auto-merging hello.py</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;输出了一大堆操作，到底是啥效果？再用git log看看：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git log --graph <span class="attribute">--pretty</span>=oneline --abbrev-commit</span><br><span class="line"></span><br><span class="line">* 7e61ed4 (HEAD -&gt; master) <span class="builtin-name">add</span> author</span><br><span class="line">* 3611cfe <span class="builtin-name">add</span> comment</span><br><span class="line">* f005ed4 (origin/master) <span class="builtin-name">set</span> <span class="attribute">exit</span>=1</span><br><span class="line">* d1be385 init hello</span><br><span class="line"><span class="built_in">..</span>.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;原本分叉的提交现在变成一条直线了。原理非常简单，Git把我们本地的提交“挪动”了位置，放到了f005ed4 (origin/master) set exit=1之后，这样整个提交历史就成了一条直线。rebase操作前后，最终的提交内容是一致的，但是我们本地的commit修改内容已经变化了，它们的修改不再基于d1be385 init hello，而是基于f005ed4 (origin/master) set exit=1，但最后的提交7e61ed4内容是一致的。</p>
<p>&emsp;&emsp;这就是rebase操作的特点：把分叉的提交历史“整理”成一条直线，看上去更直观。缺点是本地的分叉提交已经被修改过了。</p>
<p>&emsp;&emsp;最后，通过push操作把本地分支推送到远程。</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git push origin master</span><br><span class="line"></span><br><span class="line"><span class="type">Counting</span> objects: <span class="number">6</span>, <span class="keyword">done</span>.</span><br><span class="line"><span class="type">Delta</span> compression using up <span class="keyword">to</span> <span class="number">4</span> threads.</span><br><span class="line"><span class="type">Compressing</span> objects: <span class="number">100</span>% (<span class="number">5</span>/<span class="number">5</span>), <span class="keyword">done</span>.</span><br><span class="line"><span class="type">Writing</span> objects: <span class="number">100</span>% (<span class="number">6</span>/<span class="number">6</span>), <span class="number">576</span> <span class="built_in">bytes</span> | <span class="number">576.00</span> <span class="type">KiB</span>/s, <span class="keyword">done</span>.</span><br><span class="line"><span class="type">Total</span> <span class="number">6</span> (delta <span class="number">2</span>), reused <span class="number">0</span> (delta <span class="number">0</span>)</span><br><span class="line">remote: <span class="type">Resolving</span> deltas: <span class="number">100</span>% (<span class="number">2</span>/<span class="number">2</span>), completed <span class="keyword">with</span> <span class="number">1</span> local <span class="keyword">object</span>.</span><br><span class="line"><span class="type">To</span> github.com:michaelliao/learngit.git</span><br><span class="line">   f005ed4..<span class="number">7e61</span>ed4  master -&gt; master</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;再用git log看看效果，远程分支的提交历史也是一条直线。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git log --graph <span class="attribute">--pretty</span>=oneline --abbrev-commit</span><br><span class="line"></span><br><span class="line">* 7e61ed4 (HEAD -&gt; master, origin/master) <span class="builtin-name">add</span> author</span><br><span class="line">* 3611cfe <span class="builtin-name">add</span> comment</span><br><span class="line">* f005ed4 <span class="builtin-name">set</span> <span class="attribute">exit</span>=1</span><br><span class="line">* d1be385 init hello</span><br><span class="line"><span class="built_in">..</span>.</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;rebase操作可以把本地未push的分叉提交历史整理成直线；rebase的目的是使得我们在查看历史提交的变化时更容易，因为分叉的提交需要三方对比。</p>
<hr>
<h2 id="第七节-标签管理"><a href="#第七节-标签管理" class="headerlink" title="第七节 标签管理"></a><strong>第七节 标签管理</strong></h2><p>&emsp;&emsp;发布一个版本时，我们通常先在版本库中打一个标签（tag），这样就唯一确定了打标签时刻的版本。将来无论什么时候，取某个标签的版本，就是把那个打标签的时刻的历史版本取出来。所以标签也是版本库的一个快照。</p>
<p>&emsp;&emsp;Git的标签虽然是版本库的快照，但其实它就是指向某个commit的指针（跟分支很像对不对？但是分支可以移动，标签不能移动），所以，创建和删除标签都是瞬间完成的。</p>
<h3 id="创建标签"><a href="#创建标签" class="headerlink" title="创建标签"></a><strong>创建标签</strong></h3><p>&emsp;&emsp;首先切换到需要打标签的分支上。</p>
<blockquote>
<p>$ git branch</p>
<p>$ git checkout master</p>
</blockquote>
<p>&emsp;&emsp;然后，敲命令git tag就可以打一个新标签。</p>
<blockquote>
<p>$ git tag v1.0</p>
</blockquote>
<p>&emsp;&emsp;可以用命令git tag查看所有标签。</p>
<blockquote>
<p>$ git tag</p>
</blockquote>
<p>&emsp;&emsp;默认标签是打在最新提交的commit上的。有时候如果忘了打标签怎么办？方法是找到历史提交的commit id，然后打上就可以了。</p>
<blockquote>
<p>$ git log –pretty=oneline –abbrev-commit</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">12a631b (HEAD -&gt; master, tag: v1.0, origin/master) merged bug fix 101</span><br><span class="line">4c805e2 fix bug 101</span><br><span class="line">e1e9c68 merge with no-ff</span><br><span class="line">f52c633 <span class="builtin-name">add</span> merge</span><br><span class="line">cf810e4 conflict fixed</span><br><span class="line">5dc6824 &amp; simple</span><br><span class="line">14096d0 <span class="keyword">AND</span> simple</span><br><span class="line">b17d20e branch test</span><br><span class="line">d46f35e <span class="builtin-name">remove</span> test.txt</span><br><span class="line">b84166e <span class="builtin-name">add</span> test.txt</span><br><span class="line">519219b git tracks changes</span><br><span class="line">e43a48b understand how stage works</span><br><span class="line">1094adb append GPL</span><br><span class="line">e475afc <span class="builtin-name">add</span> distributed</span><br><span class="line">eaadf4e wrote a readme file</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;比方说要对add merge这次提交打标签，它对应的commit id是f52c633，敲入命令。</p>
<blockquote>
<p>$ git tag v0.9 f52c633</p>
</blockquote>
<p>&emsp;&emsp;再用命令git tag查看标签。</p>
<blockquote>
<p>$ git tag</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">v0</span><span class="selector-class">.9</span></span><br><span class="line"><span class="selector-tag">v1</span><span class="selector-class">.0</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;注意，标签不是按时间顺序列出，而是按字母排序的。可以用git show查看标签信息。</p>
<blockquote>
<p>$ git show v0.9</p>
</blockquote>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">commit f<span class="number">52</span><span class="keyword">c</span><span class="number">63349</span>bc<span class="number">3</span><span class="keyword">c</span><span class="number">1593499807e5</span><span class="keyword">c</span><span class="number">8e972</span>b<span class="number">82</span><span class="keyword">c</span><span class="number">8</span>f<span class="number">286</span> (tag: v<span class="number">0.9</span>)</span><br><span class="line">Author: Michael Liao &lt;askxuefeng<span class="title">@gmail.com</span>&gt;</span><br><span class="line">Date:   Fri May <span class="number">18</span> <span class="number">21</span>:<span class="number">56</span>:<span class="number">54</span> <span class="number">2018</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">add</span> merge</span><br><span class="line"></span><br><span class="line">diff --git a/readme.txt b/readme.txt</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;可以看到，v0.9确实打在add merge这次提交上。</p>
<p>&emsp;&emsp;还可以创建带有说明的标签，用-a指定标签名，-m指定说明文字。</p>
<blockquote>
<p>$ git tag -a v0.1 -m “version 0.1 released” 1094adb</p>
</blockquote>
<p>&emsp;&emsp;用命令git show可以看到说明文字：</p>
<blockquote>
<p>$ git show v0.1</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tag v0<span class="number">.1</span></span><br><span class="line"><span class="string">Tagger:</span> Michael Liao &lt;askxuefeng<span class="meta">@gmail</span>.com&gt;</span><br><span class="line"><span class="string">Date:</span>   Fri May <span class="number">18</span> <span class="number">22</span>:<span class="number">48</span>:<span class="number">43</span> <span class="number">2018</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">version <span class="number">0.1</span> released</span><br><span class="line"></span><br><span class="line">commit <span class="number">1094</span>adb7b9b3807259d8cb349e7df1d4d6477073 (<span class="string">tag:</span> v0<span class="number">.1</span>)</span><br><span class="line"><span class="string">Author:</span> Michael Liao &lt;askxuefeng<span class="meta">@gmail</span>.com&gt;</span><br><span class="line"><span class="string">Date:</span>   Fri May <span class="number">18</span> <span class="number">21</span>:<span class="number">06</span>:<span class="number">15</span> <span class="number">2018</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">    append GPL</span><br><span class="line"></span><br><span class="line">diff --git a<span class="regexp">/readme.txt b/</span>readme.txt</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;注意：标签总是和某个commit挂钩。如果这个commit既出现在master分支，又出现在dev分支，那么在这两个分支上都可以看到这个标签。</p>
<h3 id="操作标签"><a href="#操作标签" class="headerlink" title="操作标签"></a><strong>操作标签</strong></h3><p>&emsp;&emsp;如果标签打错了，也可以删除。</p>
<blockquote>
<p>$ git tag -d v0.1</p>
</blockquote>
<p>&emsp;&emsp;因为创建的标签都只存储在本地，不会自动推送到远程。所以，打错的标签可以在本地安全删除。</p>
<p>&emsp;&emsp;如果要推送某个标签到远程，使用命令git push origin。</p>
<blockquote>
<p>$ git push origin v1.0</p>
</blockquote>
<p>&emsp;&emsp;或者，一次性推送全部尚未推送到远程的本地标签。</p>
<blockquote>
<p>$ git push origin –tags</p>
</blockquote>
<p>&emsp;&emsp;如果标签已经推送到远程，要删除远程标签就麻烦一点，先从本地删除。</p>
<blockquote>
<p>$ git tag -d v0.9</p>
</blockquote>
<p>&emsp;&emsp;然后，从远程删除。删除命令也是push，但是格式如下。</p>
<blockquote>
<p>$ git push origin :refs/tags/v0.9</p>
</blockquote>
<p>&emsp;&emsp;要看看是否真的从远程库删除了标签，可以登陆GitHub查看。</p>
<hr>
<h2 id="第八节-使用GitHub参与开源项目"><a href="#第八节-使用GitHub参与开源项目" class="headerlink" title="第八节 使用GitHub参与开源项目"></a><strong>第八节 使用GitHub参与开源项目</strong></h2><p>&emsp;&emsp;我们一直用GitHub作为免费的远程仓库，如果是个人的开源项目，放到GitHub上是完全没有问题的。其实GitHub还是一个开源协作社区，通过GitHub，既可以让别人参与你的开源项目，也可以参与别人的开源项目。</p>
<p>&emsp;&emsp;在GitHub出现以前，开源项目开源容易，但让广大人民群众参与进来比较困难，因为要参与，就要提交代码，而给每个想提交代码的群众都开一个账号那是不现实的，因此，群众也仅限于报个bug，即使能改掉bug，也只能把diff文件用邮件发过去，很不方便。但是在GitHub上，利用Git极其强大的克隆和分支功能，广大人民群众真正可以第一次自由参与各种开源项目了。</p>
<p>&emsp;&emsp;如何参与一个开源项目呢？比如人气极高的bootstrap项目，这是一个非常强大的CSS框架，你可以访问它的项目主页<a href="https://github.com/twbs/bootstrap，点“Fork”就在自己的账号下克隆了一个bootstrap仓库，然后，从自己的账号下clone：" target="_blank" rel="noopener">https://github.com/twbs/bootstrap，点“Fork”就在自己的账号下克隆了一个bootstrap仓库，然后，从自己的账号下clone：</a></p>
<blockquote>
<p>git clone <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:michaelliao/bootstrap.git</p>
</blockquote>
<p>&emsp;&emsp;一定要从自己的账号下clone仓库，这样你才能推送修改。如果从bootstrap的作者的仓库地址<a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:twbs/bootstrap.git克隆，因为没有权限，你将不能推送修改。</p>
<p>&emsp;&emsp;Bootstrap的官方仓库twbs/bootstrap、你在GitHub上克隆的仓库my/bootstrap，以及你自己克隆到本地电脑的仓库，他们的关系就像下图显示的那样：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌─ GitHub ────────────────────────────────────┐</span><br><span class="line">│                                             │</span><br><span class="line">│ ┌─────────────────┐     ┌─────────────────┐ │</span><br><span class="line">│ │ twbs/<span class="keyword">bootstrap</span>  │────&gt;│  my/<span class="keyword">bootstrap</span>   │ │</span><br><span class="line">│ └─────────────────┘     └─────────────────┘ │</span><br><span class="line">│                                  ▲          │</span><br><span class="line">└──────────────────────────────────┼──────────┘</span><br><span class="line">                                   ▼</span><br><span class="line">                          ┌─────────────────┐</span><br><span class="line">                          │ <span class="keyword">local</span>/<span class="keyword">bootstrap</span> │</span><br><span class="line">                          └─────────────────┘</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;如果你想修复bootstrap的一个bug，或者新增一个功能，立刻就可以开始干活，干完后，往自己的仓库推送。</p>
<p>&emsp;&emsp;如果你希望bootstrap的官方库能接受你的修改，你就可以在GitHub上发起一个pull request。当然，对方是否接受你的pull request就不一定了。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a><strong>小结</strong></h3><p>&emsp;&emsp;在GitHub上，可以任意Fork开源仓库；</p>
<p>&emsp;&emsp;自己拥有Fork后的仓库的读写权限；</p>
<p>&emsp;&emsp;可以推送pull request给官方仓库来贡献代码。</p>
<hr>
<h2 id="第九节-搭建Git服务器"><a href="#第九节-搭建Git服务器" class="headerlink" title="第九节 搭建Git服务器"></a><strong>第九节 搭建Git服务器</strong></h2><p>&emsp;&emsp;GitHub就是一个免费托管开源代码的远程仓库。但是对于某些视源代码如生命的商业公司来说，既不想公开源代码，又舍不得给GitHub交保护费，那就只能自己搭建一台Git服务器作为私有仓库使用。</p>
<p>&emsp;&emsp;搭建Git服务器需要准备一台运行Linux的机器，强烈推荐用Ubuntu或Debian，这样通过几条简单的apt命令就可以完成安装。</p>
<p>&emsp;&emsp;假设你已经有sudo权限的用户账号，下面正式开始安装。</p>
<ol>
<li>第一步，安装git：</li>
</ol>
<blockquote>
<p>$ sudo apt-get install git</p>
</blockquote>
<ol start="2">
<li>第二步，创建一个git用户，用来运行git服务</li>
</ol>
<blockquote>
<p>$ sudo adduser git</p>
</blockquote>
<ol start="3">
<li>第三步，创建证书登录：</li>
</ol>
<p>&emsp;&emsp;收集所有需要登录的用户的公钥，就是他们自己的id_rsa.pub文件，把所有公钥导入到/home/git/.ssh/authorized_keys文件里，一行一个。</p>
<ol start="4">
<li>第四步，初始化Git仓库：</li>
</ol>
<p>&emsp;&emsp;先选定一个目录作为Git仓库，假定是/srv/sample.git，在/srv目录下输入命令：</p>
<blockquote>
<p>$ sudo git init –bare sample.git</p>
</blockquote>
<p>&emsp;&emsp;Git就会创建一个裸仓库，裸仓库没有工作区，因为服务器上的Git仓库纯粹是为了共享，所以不让用户直接登录到服务器上去改工作区，并且服务器上的Git仓库通常都以.git结尾。然后，把owner改为git：</p>
<blockquote>
<p>$ sudo chown -R git:git sample.git</p>
</blockquote>
<ol start="5">
<li>第五步，禁用shell登录：</li>
</ol>
<p>&emsp;&emsp;出于安全考虑，第二步创建的git用户不允许登录shell，这可以通过编辑/etc/passwd文件完成。找到类似下面的一行：</p>
<blockquote>
<p>git:x:1001:1001:,,,:/home/git:/bin/bash</p>
</blockquote>
<p>&emsp;&emsp;改为：</p>
<blockquote>
<p>git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell</p>
</blockquote>
<p>&emsp;&emsp;这样，git用户可以正常通过ssh使用git，但无法登录shell，因为我们为git用户指定的git-shell每次一登录就自动退出。</p>
<ol start="6">
<li>第六步，克隆远程仓库：</li>
</ol>
<p>现在，可以通过git clone命令克隆远程仓库了，在各自的电脑上运行：</p>
<blockquote>
<p>$ git clone git@server:/srv/sample.git</p>
</blockquote>
<p>Cloning into ‘sample’…<br>warning: You appear to have cloned an empty repository.</p>
<p>&emsp;&emsp;剩下的推送就简单了。</p>
<h3 id="管理公钥"><a href="#管理公钥" class="headerlink" title="管理公钥"></a><strong>管理公钥</strong></h3><p>&emsp;&emsp;如果团队很小，把每个人的公钥收集起来放到服务器的/home/git/.ssh/authorized_keys文件里就是可行的。如果团队有几百号人，就没法这么玩了，这时，可以用Gitosis来管理公钥。这里我们不介绍怎么玩Gitosis了，几百号人的团队基本都在500强了，相信找个高水平的Linux管理员问题不大。</p>
<h3 id="管理权限"><a href="#管理权限" class="headerlink" title="管理权限"></a><strong>管理权限</strong></h3><p>&emsp;&emsp;有很多不但视源代码如生命，而且视员工为窃贼的公司，会在版本控制系统里设置一套完善的权限控制，每个人是否有读写权限会精确到每个分支甚至每个目录下。因为Git是为Linux源代码托管而开发的，所以Git也继承了开源社区的精神，不支持权限控制。不过，因为Git支持钩子（hook），所以，可以在服务器端编写一系列脚本来控制提交等操作，达到权限控制的目的。Gitolite就是这个工具。这里我们也不介绍Gitolite了，不要把有限的生命浪费到权限斗争中。</p>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a><strong>小结</strong></h3><p>&emsp;&emsp;搭建Git服务器非常简单，通常10分钟即可完成；</p>
<p>&emsp;&emsp;要方便管理公钥，用Gitosis；</p>
<p>&emsp;&emsp;要像SVN那样变态地控制权限，用Gitolite。</p>
<hr>
<p><em>参考博客和文章书籍等：</em></p>
<blockquote>
<p><a href="https://www.liaoxuefeng.com/wiki/896043488029600" title="Title" target="_blank" rel="noopener">廖雪峰的官方网站</a></p>
</blockquote>
<blockquote>
<p><a href="https://nvie.com/posts/a-successful-git-branching-model/" title="Title" target="_blank" rel="noopener">A successful Git branching model</a></p>
</blockquote>
<p><em>因博客主等未标明不可引用，若部分内容涉及侵权请及时告知，我会尽快修改和删除相关内容</em></p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    林沂水
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://linyishui.top/2019090501.html" title="Git <整>">http://linyishui.top/2019090501.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    
      <div>
         ﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      </div>
    
    
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/git/" rel="tag"># git</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019090401.html" rel="next" title="《设计模式：可复用面向对象软件的基础》读书笔记">
                <i class="fa fa-chevron-left"></i> 《设计模式：可复用面向对象软件的基础》读书笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019090601.html" rel="prev" title="stanford公开课sql基础题">
                stanford公开课sql基础题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
     <div class="comments" id="comments">
       

<script src="https://utteranc.es/client.js" repo="LAILAIWA/LAILAIWA.github.io" issue-term="pathname" label="💬Comments" theme="github-light" crossorigin="anonymous" async>
</script>



     </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/riho_yoshioka1.jpg" alt="林沂水">
            
              <p class="site-author-name" itemprop="name">林沂水</p>
              <p class="site-description motion-element" itemprop="description">记录编程点滴，写点生活中的酸甜</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">296</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">98</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/LAILAIWA" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:linyishui168@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/linyishui618" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/linyishui618" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/5340162234" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo.com"></i>Weibo</a>
                  </span>
                
            </div>
          

          
          

          
          

          <div id="days"></div>
<script>
function show_date_time(){
    window.setTimeout("show_date_time()", 1000);
    BirthDay=new Date("07/26/2018 00:00:00");
    today=new Date();
    timeold=(today.getTime()-BirthDay.getTime());
    sectimeold=timeold/1000
    secondsold=Math.floor(sectimeold);
    msPerDay=24*60*60*1000
    e_daysold=timeold/msPerDay
    daysold=Math.floor(e_daysold);
    e_hrsold=(e_daysold-daysold)*24;
    hrsold=setzero(Math.floor(e_hrsold));
    e_minsold=(e_hrsold-hrsold)*60;
    minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
    seconds=setzero(Math.floor((e_minsold-minsold)*60));
    document.getElementById('days').innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
}
function setzero(i) {
    if (i<10) {
        i="0" + i
    };
    return i;
}
show_date_time();
</script>  
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Git"><span class="nav-number">1.</span> <span class="nav-text">Git</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一节-什么是Git"><span class="nav-number">1.1.</span> <span class="nav-text">第一节 什么是Git</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二节-安装"><span class="nav-number">1.2.</span> <span class="nav-text">第二节 安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三节-版本库"><span class="nav-number">1.3.</span> <span class="nav-text">第三节 版本库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#添加、提交、查看"><span class="nav-number">1.3.1.</span> <span class="nav-text">添加、提交、查看</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#版本回退"><span class="nav-number">1.3.2.</span> <span class="nav-text">版本回退</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四节-工作区和暂存区"><span class="nav-number">1.4.</span> <span class="nav-text">第四节 工作区和暂存区</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件修改"><span class="nav-number">1.4.1.</span> <span class="nav-text">文件修改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#撤销修改"><span class="nav-number">1.4.2.</span> <span class="nav-text">撤销修改</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除文件"><span class="nav-number">1.4.3.</span> <span class="nav-text">删除文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五节-远程仓库"><span class="nav-number">1.5.</span> <span class="nav-text">第五节 远程仓库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第六节-分支管理"><span class="nav-number">1.6.</span> <span class="nav-text">第六节 分支管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建与合并分支"><span class="nav-number">1.6.1.</span> <span class="nav-text">创建与合并分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解决冲突"><span class="nav-number">1.6.2.</span> <span class="nav-text">解决冲突</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分支管理策略"><span class="nav-number">1.6.3.</span> <span class="nav-text">分支管理策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bug分支"><span class="nav-number">1.6.4.</span> <span class="nav-text">Bug分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Feature分支"><span class="nav-number">1.6.5.</span> <span class="nav-text">Feature分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多人协作"><span class="nav-number">1.6.6.</span> <span class="nav-text">多人协作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#推送分支"><span class="nav-number">1.6.6.1.</span> <span class="nav-text">推送分支</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#抓取分支"><span class="nav-number">1.6.6.2.</span> <span class="nav-text">抓取分支</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#解决冲突-1"><span class="nav-number">1.6.6.3.</span> <span class="nav-text">解决冲突</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rebase"><span class="nav-number">1.6.7.</span> <span class="nav-text">Rebase</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第七节-标签管理"><span class="nav-number">1.7.</span> <span class="nav-text">第七节 标签管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建标签"><span class="nav-number">1.7.1.</span> <span class="nav-text">创建标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作标签"><span class="nav-number">1.7.2.</span> <span class="nav-text">操作标签</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第八节-使用GitHub参与开源项目"><span class="nav-number">1.8.</span> <span class="nav-text">第八节 使用GitHub参与开源项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#小结"><span class="nav-number">1.8.1.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第九节-搭建Git服务器"><span class="nav-number">1.9.</span> <span class="nav-text">第九节 搭建Git服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#管理公钥"><span class="nav-number">1.9.1.</span> <span class="nav-text">管理公钥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#管理权限"><span class="nav-number">1.9.2.</span> <span class="nav-text">管理权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结-1"><span class="nav-number">1.9.3.</span> <span class="nav-text">小结</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        ﻿<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">林沂水</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
   

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
