---
title: Hexo+GitHub搭建个人博客 (三) 配置nexT主题
date: 2018-07-28 10:37:22
tags: [hexo,git]
categories: 搭建博客
photos: 
    - "https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/minapple2.jpg"
---
# **一、参考文章**
*因博客主未标明不可转载，若内容涉及侵权请及时告知，我会尽快修改和删除相关内容*

Hexo+nexT主题搭建个人博客 http://www.wuxubj.cn/2016/08/Hexo-nexT-build-personal-blog/

nexT主题配置 https://www.jianshu.com/p/5d5931289c09

nexT官方文档 http://theme-next.iissnan.com/theme-settings.html

自定义配置nexT: https://segmentfault.com/a/1190000009544924

图标库 https://fontawesome.com/icons?from=io

# **二、部署nexT主题**

在项目目录终端执行命令，将主题部署到项目内
>$ git clone https://github.com/iissnan/hexo-theme-next themes/next

配置文件中将主题换为next
>theme: next

本地查看一下效果，但4000端口被占用,查看端口情况:
>netstat -o -n -a | findstr :4000

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280201.png "")

干掉进程
>taskkill /F /PID 7532

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280202.png "")

或者指定其他端口
>$ hexo s -p 5000

部署后查看以下效果

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280203.png "")

不错，简洁大方有动态效果，身为一个后端开发，前端菜鸡已经满足了

# **三、配置nexT主题**
目前是nexT默认的Scheme: Muse

接下来就进行各种自定义配置，把博客搞得好看点
## **1.添加头像**

* 新建source/images/目录，复制进去一些好看的图片，在站点配置文件添加
```
# 头像
avatar: /images/riho_yoshioka1.jpg
```
* 或者像我这样采用第二种方法

1. 首先在网上找或者自己PS一张心仪的图片,取名background.jpg，把它放在Hexo\source\image路径下。

2. 进入Hexo\themes\hexo-theme-next\source\css\_common\components\header目录，找到header.styl文件，双击打开。将第一行默认的.header { background: $head-bg; }修改为
```
// 下面的url()里不一定非要填相对路径，填一个能访问的url即可
.header { background: url('../image/background.jpg'); }
```
3. 然后重新上传博客即可

## **2.修改主题**

修改主题配置文件中的scheme
>Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白
>
>Mist - Muse 的紧凑版本，整洁有序的单栏外观
>
>Pisces - 双栏 Scheme，小家碧玉似的清新
>
>Gemini - 不太清楚

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280204.png "")

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280205.png "")

## **3.设置侧栏位置**

修改主题配置文件中的sidebar

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280206.png "")

默认是左边，display设置侧栏在什么情况显示

## **4.设置菜单**

* 首先修改主题配置文件中菜单映射

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280207.png "")
 
* 界面所显示的映射value是去languages/{yourlanguage}.yml查询的
想要修改时只需去修改{yourlanguage}.yml即可，不过要先在主题配置文件中开启这个标签。

* 设置菜单的图标: 
 
![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280208.png "")

## **5.设置社交链接**

* 修改主题配置文件

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280209.png "")

* 在图标库中搜索图标 https://fontawesome.com/icons?from=io

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280210.png "")
 
**将链接设置为居中显示:**

修改文件themes\next\source\css\_common\components\sidebar\sidebar-author-links.styl

添加如下
```
.links-of-author-item {
  text-align: center;
  }
```
## **6.创建菜单中添加映射跳转，或自定义格式**

在source目录下新建一个xx.html文件

配置menu映射即可
>xx: /xx.html
>
>xx: /xx

添加如友情链接的方法:
```
# Blogrolls 
links_title: 友情链接 
# links_layout: block 
#links_layout: inline 
links: Java学习天地: https://wangli0.github.com 
ruulai.com: https://wangli0.github.com 
视听中国: https://wangli0.github.com
```
## **7.在每篇文章末尾添加“文本结束”标记**

在\themes\next\layout\_macro 中新建 passage-end-tag.swig 文件,并添加以下内容:
```
<div>
    {% if not is_index %}
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    {% endif %}
</div>
```
接着打开\themes\next\layout\_macro\post.swig文件，在post-body 之后， post-footer 之前添加如下画红色部分代码（post-footer之前两个DIV）:

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280211.png "")

```
<div>
  {% if not is_index %}
    {% include 'passage-end-tag.swig' %}
  {% endif %}
</div>
```
然后打开主题配置文件（_config.yml),在末尾添加:
```
# 文章末尾添加“本文结束”标记
passage_end_tag:
  enabled: true
```
完成以上设置之后，在每篇文章之后都会添加如上效果图的样子。


## **8.添加标签页面**

前面通过修改next主题下的_config.yml文件中的menu选项，可以在主页面的菜单栏添加标签选项，但是此时点击标签，跳转的页面会显示page not found。

添加标签页面的具体方法是:
* 新建页面，输入如下命令:
>$ cd myBlog
>
>$ hexo new page tags

* 输入命令后，在myBlog/source下会新生成一个新的文件夹tags，在该文件夹下会有一个index.md文件。
* 设置页面类型，在上步新生成的myBlog/source/tags/index.md中添加type: "tags"，index.md文件内容如下:
```
---
title: tags
date: 2016-11-15 19:10:05
type: "tags"
---
```

* 设置具体文章的tags，当要为某一篇文章添加标签，只需在myBlog/source/_post目录下的具体文章的tags中添加标签即可，如:
```
---
title: 基于Hexo和Github搭建博客
date: 2016-11-09
tags: [npm, hexo, github]
categories: 搭建博客
---
```

## **9.添加分类页面**

步骤与添加标签页面类似，具体如下:

* 新建页面，输入如下命令:
>$ cd myBlog
>
>$ hexo new page categories

* 输入命令后，在myBlog/source下会新生成一个新的文件夹categories，在该文件夹下会有一个index.md文件。
* 设置页面类型，在上步新生成的myBlog/source/categories/index.md中添加type: "categories"，index.md文件内容如下:
```
---
title: categories
date: 2016-11-15 19:11:13
type: "categories"
---
```
* 设置具体文章的categories，当要为某一篇文章添加分类，只需在myBlog/source/_post目录下的具体文章的categories中添加分类即可，如:
```
---
title: 基于Hexo和Github搭建博客
date: XXXX-XX-XX
tags: [hexo, github]
categories: 搭建博客
---
```

## **10.添加关于我页面**

步骤与添加标签页面类似，具体如下:

* 新建页面
>$ cd myBlog
>
>$ hexo new page about

* 输入命令后，在myBlog/source下会新生成一个新的文件夹about，在该文件夹下会有一个index.md文件。
修改about/index.md，本站点index.md如下:
```
---
title: about
date: 2016-11-15 19:08:50
---
## 关于我

XXXX,XXXXXXXXX。

From XXX

QQ: XXXXXXX
Email: XXXXXX@XX.com
```

## **11.设置网站图标Favicon**

下载一个32*32的ico图标，修改主题配置文件
```
# Put your favicon.ico into `hexo-site/source/` directory.
favicon: /favicon.ico
```
实现统计功能，具体实现方法: 
* 在根目录下安装 hexo-wordcount,运行:
>$ npm install hexo-wordcount --save

然后在主题的配置文件中，配置如下:
```
# Post wordcount display settings
# Dependencies: https://github.com/willin/hexo-wordcount
post_wordcount:
  item_text: true
  wordcount: true
  min2read: true
```

## **12.添加顶部加载条**

最新版的next主题，升级后只需修改主题配置文件(_config.yml)将pace: false改为pace: true就行了

你还可以换不同样式的加载条，如下图:

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280212.png "")

## **13.隐藏网页底部powered By Hexo / 强力驱动**

打开themes/next/layout/_partials/footer.swig,使用"&lt;&#33;--&gt;"隐藏之间的代码即可，或者直接删除。

位置如图:
 
![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280213.png "")

## **14.自定义鼠标样式**

打开themes/next/source/css/_custom/custom.styl,在里面写下如下代码
```
// 鼠标样式
  * {
      cursor: url("http://om8u46rmb.bkt.clouddn.com/sword2.ico"),auto!important
  }
  :active {
      cursor: url("http://om8u46rmb.bkt.clouddn.com/sword1.ico"),auto!important
  }
```
其中 url 里面必须是 ico 图片，替换后发现实际点触和鼠标图标是有偏差的，所以我取消了鼠标的样式

## **15.为博客加上看板娘**

效果预览 https://huaji8.top/post/live2d-plugin-2.0/

源代码地址 https://github.com/EYHN/hexo-helper-live2d

具体实现方法:

* 在终端切换到你的博客的路径里，然后输入如下代码:
>npm install -save hexo-helper-live2d
* 然后打开Hexo/blog/themes/next/layout的_layout.swig,将下面代码放到</body>之前:
```
{{ live2d() }}
```

然后在在 hexo 的 _config.yml 中添加参数:
```
# 动态妹子
live2d:
  enable: true
  scriptFrom: local
  tagMode: true
  model:
    use: live2d-widget-model-shizuku
  display:
    position: right
    width: 150
    height: 300
  mobile:
    show: true
```
如果出现下面这个问题:

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280214.png "")
 
首先删除hexo 下面的.deploy_git文件夹，然后运行
>git config --global core.autocrlf false

再重新 hexo clean,hexo g,hexo d就行了

## **16.修改作者头像并旋转**

打开\themes\next\source\css\_common\components\sidebar\sidebar-author.styl，在里面添加如下代码:
```
.site-author-image {
  display: block;
  margin: 0 auto;
  padding: $site-author-image-padding;
  max-width: $site-author-image-width;
  height: $site-author-image-height;
  border: $site-author-image-border-width solid $site-author-image-border-color;

  /* 头像圆形 */
  border-radius: 80px;
  -webkit-border-radius: 80px;
  -moz-border-radius: 80px;
  box-shadow: inset 0 -1px 0 #333sf;

  /* 设置循环动画 [animation: (play)动画名称 (2s)动画播放时长单位秒或微秒 (ase-out)动画播放的速度曲线为以低速结束 
    (1s)等待1秒然后开始动画 (1)动画播放次数(infinite为循环播放) ]*/
 

  /* 鼠标经过头像旋转360度 */
  -webkit-transition: -webkit-transform 1.0s ease-out;
  -moz-transition: -moz-transform 1.0s ease-out;
  transition: transform 1.0s ease-out;
}

img:hover {
  /* 鼠标经过停止头像旋转 
  -webkit-animation-play-state:paused;
  animation-play-state:paused;*/

  /* 鼠标经过头像旋转360度 */
  -webkit-transform: rotateZ(360deg);
  -moz-transform: rotateZ(360deg);
  transform: rotateZ(360deg);
}

/* Z 轴旋转动画 */
@-webkit-keyframes play {
  0% {
    -webkit-transform: rotateZ(0deg);
  }
  100% {
    -webkit-transform: rotateZ(-360deg);
  }
}
@-moz-keyframes play {
  0% {
    -moz-transform: rotateZ(0deg);
  }
  100% {
    -moz-transform: rotateZ(-360deg);
  }
}
@keyframes play {
  0% {
    transform: rotateZ(0deg);
  }
  100% {
    transform: rotateZ(-360deg);
  }
}
```

## **17.博文压缩**

在站点的根目录下执行以下命令:
>$ npm install gulp -g
>
>$ npm install gulp-minify-css gulp-uglify gulp-htmlmin gulp-htmlclean gulp --save

根目录下新建 gulpfile.js ，并填入以下内容:
```
var gulp = require('gulp');
var minifycss = require('gulp-minify-css');
var uglify = require('gulp-uglify');
var htmlmin = require('gulp-htmlmin');
var htmlclean = require('gulp-htmlclean');
// 压缩 public 目录 css
gulp.task('minify-css', function() {
    return gulp.src('./public/**/*.css')
        .pipe(minifycss())
        .pipe(gulp.dest('./public'));
});
// 压缩 public 目录 html
gulp.task('minify-html', function() {
  return gulp.src('./public/**/*.html')
    .pipe(htmlclean())
    .pipe(htmlmin({
         removeComments: true,
         minifyJS: true,
         minifyCSS: true,
         minifyURLs: true,
    }))
    .pipe(gulp.dest('./public'))
});
// 压缩 public/js 目录 js
gulp.task('minify-js', function() {
    return gulp.src('./public/**/*.js')
        .pipe(uglify())
        .pipe(gulp.dest('./public'));
});
// 执行 gulp 命令时执行的任务
gulp.task('default', [
    'minify-html','minify-css','minify-js'
]);
```
生成博文是执行 hexo g && gulp 就会根据 gulpfile.js 中的配置，对 public 目录中的静态资源文件进行压缩

## **18.修改代码块自定义样式**

打开\themes\next\source\css\_custom\custom.styl,向里面加入: (颜色可以自己定义)
```
// Custom styles.
code {
    color: #ff7600;
    background: #fbf7f8;
    margin: 2px;
}
// 大代码块的自定义样式
.highlight, pre {
    margin: 5px 0;
    padding: 5px;
    border-radius: 3px;
}
.highlight, code, pre {
    border: 1px solid #d6d6d6;
}
```

## **19.主页文章添加阴影效果**

打开\themes\next\source\css\_custom\custom.styl,向里面加入
```
// 主页文章添加阴影效果
 .post {
   margin-top: 60px;
   margin-bottom: 60px;
   padding: 25px;
   -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);
   -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);
  }
```

## **20.在网站底部加上访问量**

打开\themes\next\layout\_partials\footer.swig文件,在copyright前加上这句话
```
<script async src="https://dn-
lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
```

然后再合适的位置添加显示统计的代码:

![](https://pic-1258215793.cos.ap-shanghai.myqcloud.com/content/20180728/201807280215.png "")

```
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
```

在这里有两中不同计算方式的统计代码
* pv的方式，单个用户连续点击n篇文章，记录n次访问量
```
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
```
* uv的方式，单个用户连续点击n篇文章，只记录1次访客数
```
<span id="busuanzi_container_site_uv">
  本站总访问量<span id="busuanzi_value_site_uv"></span>次
</span>
```

添加之后再执行hexo d -g，然后再刷新页面就能看到效果

## **21.next主题如何添加动态背景**

如果next主题在5.1.1以上的话，直接在主题配置文件中找到canvas_nest: false，把它改为canvas_nest: true就行了（注意分号后面要加一个空格）

## **22.hexo首页文章只显示部分内容**

这个只要在文章中加上&lt;&#33;--more--&gt;标记 ，该标记以后部分就不在显示了，只有展开全部才显示，这是hexo定义的

但这样手动配置感觉会很麻烦，所以使用以下方法自动截取：

* 进入hexo博客项目的themes/next目录
* 用文本编辑器打开_config.yml文件
* 搜索"auto_excerpt",找到如下部分
```
# Automatically Excerpt. Not recommand.
# Please use <!-- more --> in the post to control excerpt accurately.
auto_excerpt:
  enable: false
  length: 150
```
把enable改为对应的false改为true，然后hexo d -g，再进主页，问题就解决了！

# **四、注意**
***TIPS: Markdown对特殊字符的处理不太好，在使用&#92;来转义的时候经常会有问题，所以我是使用HTML转义字符***

***&#123;&#123;&#125;&#125; 一定要被代码块包括，不然hexo会出现解析问题***