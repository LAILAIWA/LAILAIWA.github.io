<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/gamepad%20playstation.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Dig%20Dug.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/gamepad%20playstation.png">
  <link rel="mask-icon" href="/images/gamepad%20playstation.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CMa+Shan+Zheng:300,300italic,400,400italic,700,700italic%7CNoto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" integrity="sha256-no0c5ccDODBwp+9hSmV5VvPpKwHCpbVzXHexIkupM6U=" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js" integrity="sha256-a5YRB27CcBwBFcT5EF/f3E4vzIqyHrSR878nseNYw64=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"linyishui.top","root":"/","images":"/images","scheme":"Pisces","version":"8.6.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="stanford公开课sql基础题">
<meta property="og:type" content="article">
<meta property="og:title" content="stanford公开课sql基础题">
<meta property="og:url" content="http://linyishui.top/2019090601.html">
<meta property="og:site_name" content="俺的部落格">
<meta property="og:description" content="stanford公开课sql基础题">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-09-06T07:28:55.000Z">
<meta property="article:modified_time" content="2019-10-28T12:12:46.000Z">
<meta property="article:author" content="Lys">
<meta property="article:tag" content="sql">
<meta property="article:tag" content="database">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://linyishui.top/2019090601.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://linyishui.top/2019090601.html","path":"2019090601.html","title":"stanford公开课sql基础题"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>stanford公开课sql基础题 | 俺的部落格</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="俺的部落格" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">俺的部落格</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">俺寻思俺需要记点东西</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
        <li class="menu-item menu-item-tools"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>工具</a></li>
        <li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>书架</a></li>
        <li class="menu-item menu-item-movies"><a href="/movies/" rel="section"><i class="fa fa-video fa-fw"></i>剧院</a></li>
        <li class="menu-item menu-item-games"><a href="/games/" rel="section"><i class="fa fa-gamepad fa-fw"></i>游戏</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E5%9F%BA%E7%A1%80%E9%A2%98"><span class="nav-text">sql基础题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%AF%BE%E4%BB%B6%E9%A2%98%E7%9B%AE"><span class="nav-text">一、课件题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%BB%BA%E8%A1%A8%E3%80%81%E6%95%B0%E6%8D%AE"><span class="nav-text">二、建表、数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E4%BD%9C%E7%AD%94"><span class="nav-text">三、作答</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%AD%94%E6%A1%88"><span class="nav-text">四、答案</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Lys"
      src="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/IMG_0759.JPG">
  <p class="site-author-name" itemprop="name">Lys</p>
  <div class="site-description" itemprop="description">记录编程点滴，写点生活中的酸甜</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">331</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">110</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LAILAIWA" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LAILAIWA" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:linyishui168@outlook.com" title="E-Mail → mailto:linyishui168@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/5340162234" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;5340162234" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/linyishui618" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;linyishui618" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/13018339/lin-yishui" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;13018339&#x2F;lin-yishui" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/linyishui618" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;linyishui618" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="far fa-smile-wink fa-fw"></i>
      个人
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://music.163.com/#/user/home?id=68425607" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;68425607" rel="noopener" target="_blank">网易云音乐</a>
        </li>
    </ul>
  </div>

          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/LAILAIWA" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://linyishui.top/2019090601.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/IMG_0759.JPG">
      <meta itemprop="name" content="Lys">
      <meta itemprop="description" content="记录编程点滴，写点生活中的酸甜">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="俺的部落格">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          stanford公开课sql基础题
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-09-06 15:28:55" itemprop="dateCreated datePublished" datetime="2019-09-06T15:28:55+08:00">2019-09-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2019-10-28 20:12:46" itemprop="dateModified" datetime="2019-10-28T20:12:46+08:00">2019-10-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">技术文档</span></a>
        </span>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>15 分钟</span>
    </span>
</div>

            <div class="post-description">stanford公开课sql基础题</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="sql基础题"><a href="#sql基础题" class="headerlink" title="sql基础题"></a><strong>sql基础题</strong></h1><h2 id="一、课件题目"><a href="#一、课件题目" class="headerlink" title="一、课件题目"></a><strong>一、课件题目</strong></h2><p>&emsp;&emsp;Suppose you’ve started a new movie-rating website, and you’ve been collecting data on reviewers’ ratings of various movies. There’s not much data yet, but you can still try out some interesting queries. Here’s the schema:  </p>
<p>&emsp;&emsp;Movie ( <u>mID</u>, title, year, director )  There is a movie with ID number mID, a title, a release year, and a director.  </p>
<p>&emsp;&emsp;Reviewer ( <u>rID</u>, name )  The reviewer with ID number rID has a certain name.  </p>
<p>&emsp;&emsp;Rating ( <u>rID</u>, <u>mID</u>, stars, ratingDate ) [rID, mID are foreign keys] The reviewer rID gave the movie mID a number of stars rating (1-5) on a certain ratingDate. </p>
<p>&emsp;&emsp;Write SQL statements to answer the following questions: </p>
<ol>
<li>Find the titles of all movies directed by Steven Spielberg.  </li>
<li>Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order of rating.  </li>
<li>Find the titles of all movies that have no ratings.  </li>
<li>Some reviewers didn’t provide a date with their rating. Find the names of all reviewers who have ratings with a NULL value for the date.  </li>
<li>Write a query to return the ratings data in a more readable format: reviewer name, movie title, stars, and ratingDate. </li>
<li>For all cases where the same reviewer rated the same movie twice and gave it a higher rating the second time, return the reviewer’s name and the title of the movie.  </li>
<li>For each movie that has at least one rating, find the highest number of stars that movie received. Return the movie title and number of stars. Sort by movie title. (hint: use GROUP BY)  </li>
<li>List movie titles and average ratings, from highest-rated to lowest-rated. If two or more movies have the same average rating, list them in alphabetical order.  </li>
<li>Find the names of all reviewers who have contributed three or more ratings.  </li>
<li>Find the names of all reviewers who rated Gone with the Wind. </li>
<li>For any rating where the reviewer is the same as the director of the movie, return the reviewer name, movie title, and number of stars. </li>
<li>Return all reviewer names and movie names together in a single column, alphabetized. (Sorting by the first name of the reviewer and first word in the title is fine; no need for special processing on last names or removing “The”.) </li>
<li>Find the titles of all movies not reviewed by Chris Jackson. </li>
<li>For all pairs of reviewers such that both reviewers gave a rating to the same movie, return the names of both reviewers. Eliminate duplicates, don’t pair reviewers with themselves, and include each pair only once. For each pair, return the names in the pair in alphabetical order. </li>
<li>For each rating that is the lowest (fewest stars) in the database, return the reviewer name, movie title, and number of stars of such ratings. </li>
<li>Find the reviewer who reviewed all movies. </li>
<li>Find the movies reviewed by Sarah Martinez and not reviewed by Chris Jackson. (hint: use NOT IN) </li>
<li>Find the movies that have been reviewed by at least two reviewers. Please write an SQL with only one SELECT and without GROUP BY. </li>
<li>Find the movies that have been reviewed by at least two reviewers. Please write an SQL with subquery. </li>
<li>Find the reviewers who do not review any movie. </li>
</ol>
<p>&emsp;&emsp;Note: When you use XAMPP+MySQL to check the correctness of your solution, please be noted that EXCEPT is not supported in MySQL.</p>
<h2 id="二、建表、数据"><a href="#二、建表、数据" class="headerlink" title="二、建表、数据"></a><strong>二、建表、数据</strong></h2><p>&emsp;&emsp;基于SqlServer。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建数据库</span></span><br><span class="line"><span class="keyword">create</span> database standford;</span><br><span class="line"></span><br><span class="line">use standford;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> movie(</span><br><span class="line">    mid <span class="type">int</span> <span class="keyword">primary</span> key ,</span><br><span class="line">    title <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    <span class="keyword">year</span> <span class="type">int</span>,</span><br><span class="line">    director <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> reviewer(</span><br><span class="line">    rid <span class="type">int</span> <span class="keyword">primary</span> key ,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> rating(</span><br><span class="line">    mid <span class="type">int</span>,</span><br><span class="line">    rid <span class="type">int</span>,</span><br><span class="line">    stars <span class="type">int</span>,</span><br><span class="line">    ratingDate <span class="type">date</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> rating </span><br><span class="line">  <span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_rating_movie_mid <span class="keyword">FOREIGN</span> KEY (mid) <span class="keyword">references</span> movie(mid);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> rating </span><br><span class="line">  <span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_rating_reviewer_rid <span class="keyword">FOREIGN</span> KEY (rid) <span class="keyword">references</span> reviewer(rid);</span><br><span class="line"></span><br><span class="line"><span class="comment">--填充数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">101</span>,<span class="string">&#x27;Gone with the Wind&#x27;</span>,<span class="number">1939</span>,<span class="string">&#x27;Victor Fleming&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">102</span>,<span class="string">&#x27;Star Wars&#x27;</span>,<span class="number">1977</span>,<span class="string">&#x27;George Lucas&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">103</span>,<span class="string">&#x27;The Sound of Music&#x27;</span>,<span class="number">1965</span>,<span class="string">&#x27;Robert Wise&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">104</span>,<span class="string">&#x27;E.T.&#x27;</span>,<span class="number">1982</span>,<span class="string">&#x27;Steven Spielberg&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">105</span>,<span class="string">&#x27;Titanic&#x27;</span>,<span class="number">1997</span>,<span class="string">&#x27;James Cameron&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">106</span>,<span class="string">&#x27;Snow White&#x27;</span>,<span class="number">1937</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">107</span>,<span class="string">&#x27;Avatar&#x27;</span>,<span class="number">2009</span>,<span class="string">&#x27;James Cameron&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(mid,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">108</span>,<span class="string">&#x27;Raiders of the Lost Ark&#x27;</span>,<span class="number">1981</span>,<span class="string">&#x27;Steven Spielberg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">201</span>,<span class="string">&#x27;Sarah Martinez&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">202</span>,<span class="string">&#x27;Daniel Lewis&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">203</span>,<span class="string">&#x27;Brittany Harris&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">204</span>,<span class="string">&#x27;Mike Anderson&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">205</span>,<span class="string">&#x27;Chris Jackson&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">206</span>,<span class="string">&#x27;Elizabeth Thomas&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">207</span>,<span class="string">&#x27;James Cameron&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,name) <span class="keyword">values</span> (<span class="number">208</span>,<span class="string">&#x27;Ashley White&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">201</span>,<span class="number">101</span>,<span class="number">2</span>,<span class="string">&#x27;2011-01-22&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">201</span>,<span class="number">101</span>,<span class="number">4</span>,<span class="string">&#x27;2011-01-27&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">202</span>,<span class="number">106</span>,<span class="number">4</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">103</span>,<span class="number">2</span>,<span class="string">&#x27;2011-01-20&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">108</span>,<span class="number">4</span>,<span class="string">&#x27;2011-01-12&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">108</span>,<span class="number">2</span>,<span class="string">&#x27;2011-01-30&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">204</span>,<span class="number">101</span>,<span class="number">3</span>,<span class="string">&#x27;2011-01-09&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">103</span>,<span class="number">3</span>,<span class="string">&#x27;2011-01-27&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">104</span>,<span class="number">2</span>,<span class="string">&#x27;2011-01-22&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">108</span>,<span class="number">4</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">206</span>,<span class="number">107</span>,<span class="number">3</span>,<span class="string">&#x27;2011-01-15&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">206</span>,<span class="number">106</span>,<span class="number">5</span>,<span class="string">&#x27;2011-01-19&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">207</span>,<span class="number">107</span>,<span class="number">5</span>,<span class="string">&#x27;2011-01-20&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,mid,stars,ratingDate) <span class="keyword">values</span> (<span class="number">208</span>,<span class="number">104</span>,<span class="number">3</span>,<span class="string">&#x27;2011-01-02&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="三、作答"><a href="#三、作答" class="headerlink" title="三、作答"></a><strong>三、作答</strong></h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--1. Find the titles of all movies directed by Steven Spielberg.  </span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> director = <span class="string">&#x27;Steven Spielberg&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2. Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order of rating.  </span></span><br><span class="line"><span class="keyword">select</span> year</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left join</span> (<span class="keyword">select</span> max(stars) <span class="keyword">as</span> maxStars,mid <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> mid) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span> </span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> movie.mid = rating.mid</span><br><span class="line">			   <span class="keyword">and</span> rating.stars <span class="keyword">in</span> (<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> (<span class="keyword">select</span> max(stars) <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid <span class="keyword">group</span> <span class="keyword">by</span> mid),year;</span><br><span class="line"></span><br><span class="line"><span class="comment">--对应</span></span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left join</span> rating</span><br><span class="line"><span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left join</span> (<span class="keyword">select</span> max(stars) <span class="keyword">as</span> maxStars,mid <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> mid) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> rating.stars <span class="keyword">in</span> (<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> maxStars,year;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3. Find the titles of all movies that have no ratings.  </span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> movie.mid = rating.mid);</span><br><span class="line"></span><br><span class="line"><span class="comment">--4. Some reviewers didn&#x27;t provide a date with their rating. Find the names of all reviewers who have ratings with a NULL value for the date.  </span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> reviewer.rid = rating.rid</span><br><span class="line">			   <span class="keyword">and</span> ratingDate <span class="keyword">is</span> <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--5. Write a query to return the ratings data in a more readable format: reviewer name, movie title, stars, and ratingDate. </span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,</span><br><span class="line">	   rating.stars,</span><br><span class="line">	   rating.ratingDate</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid;</span><br><span class="line"></span><br><span class="line"><span class="comment">--6. For all cases where the same reviewer rated the same movie twice and gave it a higher rating the second time, return the reviewer&#x27;s name and the title of the movie.  </span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,ratingDate,stars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">left join</span> (<span class="keyword">select</span> max(ratingDate) <span class="keyword">as</span> maxDate,max(stars) <span class="keyword">as</span> maxStars,mid,rid</span><br><span class="line">           <span class="keyword">from</span> rating</span><br><span class="line">		   <span class="keyword">group</span> <span class="keyword">by</span> mid,rid) maxSelect</span><br><span class="line"><span class="keyword">on</span> rating.rid = maxSelect.rid <span class="keyword">and</span> rating.mid = maxSelect.mid</span><br><span class="line"><span class="keyword">where</span> rating.ratingDate = maxDate <span class="keyword">and</span> rating.stars = maxStars</span><br><span class="line">  <span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating r</span><br><span class="line">	         <span class="keyword">group</span> <span class="keyword">by</span> mid,rid</span><br><span class="line">	         <span class="keyword">having</span> rating.rid = r.rid</span><br><span class="line">	            <span class="keyword">and</span> rating.mid = r.mid</span><br><span class="line">	            <span class="keyword">and</span> count(*) = <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--7. For each movie that has at least one rating, find the highest number of stars that movie received. Return the movie title and number of stars. Sort by movie title. (hint: use GROUP BY)  </span></span><br><span class="line"><span class="keyword">select</span> movie.title,maxStars</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left join</span> (<span class="keyword">select</span> max(stars) <span class="keyword">as</span> maxStars,mid <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> mid) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid <span class="keyword">group</span> <span class="keyword">by</span> mid <span class="keyword">having</span> count(*) &gt; <span class="number">0</span>)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> movie.title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--8. List movie titles and average ratings, from highest-rated to lowest-rated. If two or more movies have the same average rating, list them in alphabetical order.  </span></span><br><span class="line"><span class="keyword">select</span> movie.title,AVG(stars) <span class="keyword">as</span> avgStars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> movie.mid,movie.title</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> AVG(stars) <span class="keyword">desc</span>,movie.title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--9. Find the names of all reviewers who have contributed three or more ratings.  </span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> rating.rid = reviewer.rid</span><br><span class="line">	         <span class="keyword">group</span> <span class="keyword">by</span> rid</span><br><span class="line">			 <span class="keyword">having</span> count(*) &gt; <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--10. Find the names of all reviewers who rated Gone with the Wind. </span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">left join</span> movie <span class="keyword">on</span> rating.mid = movie.mid</span><br><span class="line">			 <span class="keyword">where</span> rating.rid = reviewer.rid</span><br><span class="line">	           <span class="keyword">and</span> title = <span class="string">&#x27;Gone with the Wind&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--11. For any rating where the reviewer is the same as the director of the movie, return the reviewer name, movie title, and number of stars. </span></span><br><span class="line"><span class="comment">--查询导演作为评论人的电影，返回评论人名和电影名</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">where</span> reviewer.name = movie.director;</span><br><span class="line"></span><br><span class="line"><span class="comment">--12. Return all reviewer names and movie names together in a single column, alphabetized. (Sorting by the first name of the reviewer and first word in the title is fine; no need for special processing on last names or removing &quot;The&quot;.) </span></span><br><span class="line"><span class="comment">--把所有评论人名和电影名放入一列返回，按评论人名和标题名首字母排序，不需要对姓氏进行特殊处理或删除“the”</span></span><br><span class="line"><span class="keyword">select</span> title <span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span> <span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--13. Find the titles of all movies not reviewed by Chris Jackson. </span></span><br><span class="line"><span class="comment">--查询所有未受Chris Jackson评论的电影名</span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">left join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line">			 <span class="keyword">where</span> rating.mid = movie.mid</span><br><span class="line">	           <span class="keyword">and</span> <span class="type">name</span> = <span class="string">&#x27;Chris Jackson&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">--14. For all pairs of reviewers such that both reviewers gave a rating to the same movie, return the names of both reviewers. Eliminate duplicates, don&#x27;t pair reviewers with themselves, and include each pair only once. For each pair, return the names in the pair in alphabetical order. </span></span><br><span class="line"><span class="comment">--当有两个评论人给同个电影评论时返回两个评论人名，删除重复项，按姓名排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> reviewer1.name &lt;= reviewer2.name <span class="keyword">then</span> reviewer1.name <span class="keyword">else</span> reviewer2.name <span class="keyword">end</span> a, <span class="comment">--去除顺序相关</span></span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> reviewer1.name &lt;= reviewer2.name <span class="keyword">then</span> reviewer2.name <span class="keyword">else</span> reviewer1.name <span class="keyword">end</span> b</span><br><span class="line">            <span class="keyword">from</span> rating r1</span><br><span class="line">            <span class="keyword">join</span> reviewer reviewer1 <span class="keyword">on</span> r1.rid = reviewer1.rid</span><br><span class="line">			<span class="keyword">join</span> rating r2 <span class="keyword">on</span> r1.mid = r2.mid <span class="keyword">and</span> r1.rid != r2.rid <span class="comment">--配对</span></span><br><span class="line">			<span class="keyword">join</span> reviewer reviewer2 <span class="keyword">on</span> r2.rid = reviewer2.rid) m</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a,b <span class="comment">--分组去重</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a,b; <span class="comment">--按姓名排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--顺序相关去重 select * from tb1 group by A, B having count(*) &gt;0;</span></span><br><span class="line"><span class="comment">--顺序不相关去重 select aa,bb from (select case when a&lt;=b then a else b end aa,case when a&lt;=b then b else a end bb from tbl) tt group by aa,bb;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--15. For each rating that is the lowest (fewest stars) in the database, return the reviewer name, movie title, and number of stars of such ratings. </span></span><br><span class="line"><span class="comment">--查询库中的最低评分，返回评论人名，电影名和评分</span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,</span><br><span class="line">	   stars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">where</span> rating.stars = (<span class="keyword">select</span> min(stars) <span class="keyword">from</span> rating);</span><br><span class="line"></span><br><span class="line"><span class="comment">--16. Find the reviewer who reviewed all movies. </span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> count(*)</span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">SELECT</span> <span class="keyword">distinct</span> rid,mid</span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">             <span class="keyword">where</span> reviewer.rid = rating.rid ) a ) <span class="comment">--统计当前用户观看电影数</span></span><br><span class="line">      = (<span class="keyword">select</span> count(*) <span class="keyword">from</span> movie); <span class="comment">--统计电影总数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--17. Find the movies reviewed by Sarah Martinez and not reviewed by Chris Jackson. (hint: use NOT IN) </span></span><br><span class="line"><span class="comment">--查询Sarah Martinez有评论而Chris Jackson未评论的电影</span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> mid <span class="keyword">in</span> (<span class="keyword">select</span> mid <span class="keyword">from</span> rating,reviewer <span class="keyword">where</span> rating.rid = reviewer.rid <span class="keyword">and</span> reviewer.name = <span class="string">&#x27;Sarah Martinez&#x27;</span>)</span><br><span class="line">  <span class="keyword">and</span> mid <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> mid <span class="keyword">from</span> rating,reviewer <span class="keyword">where</span> rating.rid = reviewer.rid <span class="keyword">and</span> reviewer.name = <span class="string">&#x27;Chris Jackson&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--18. Find the movies that have been reviewed by at least two reviewers. Please write an SQL with only one SELECT and without GROUP BY. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> a.mid</span><br><span class="line"><span class="keyword">from</span> rating <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">join</span> rating <span class="keyword">as</span> b </span><br><span class="line"><span class="keyword">on</span> a.mid = b.mid </span><br><span class="line"><span class="keyword">and</span> a.rid != b.rid;</span><br><span class="line"></span><br><span class="line"><span class="comment">--19. Find the movies that have been reviewed by at least two reviewers. Please write an SQL with subquery. </span></span><br><span class="line"><span class="keyword">select</span> mid,title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> count(*) <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid) &gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--20. Find the reviewers who do not review any movie. </span></span><br><span class="line"><span class="keyword">select</span> <span class="type">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> count(*) <span class="keyword">from</span> rating <span class="keyword">where</span> reviewer.rid = rating.rid) = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h2 id="四、答案"><a href="#四、答案" class="headerlink" title="四、答案"></a><strong>四、答案</strong></h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">FROM</span> movie <span class="keyword">Where</span> director=<span class="string">&#x27;Steven Spielberg&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Year,stars <span class="keyword">From</span> movie, rating <span class="keyword">WHERE</span> movie.mID=rating.mID <span class="keyword">and</span> (rating.stars = <span class="number">4</span> <span class="keyword">OR</span> rating.stars= <span class="number">5</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> rating.stars <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">from</span> movie <span class="keyword">where</span> mID <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> mID <span class="keyword">from</span> rating )</span><br><span class="line">(mysql does <span class="keyword">not</span> support <span class="keyword">except</span>)(<span class="keyword">SELECT</span> title <span class="keyword">FROM</span> movie) <span class="keyword">EXCEPT</span> (<span class="keyword">SELECT</span> title <span class="keyword">FROM</span> movie, rating  <span class="keyword">WHERE</span> movie.mID = rating.mID)</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">Name</span> <span class="keyword">FROM</span> reviewer, rating <span class="keyword">WHERE</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.ratingDate <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span>, title, stars, ratingDate <span class="keyword">FROM</span> movie, rating, reviewer <span class="keyword">WHERE</span> movie.mID = rating.mID <span class="keyword">AND</span> reviewer.rID = rating.rID;</span><br><span class="line"><span class="number">5.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span>, title, stars, ratingDate <span class="keyword">FROM</span> movie <span class="keyword">join</span> rating <span class="keyword">join</span> reviewer <span class="keyword">ON</span> movie.mID = rating.mID <span class="keyword">AND</span> reviewer.rID = rating.rID;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span>, title <span class="keyword">From</span> movie , reviewer, rating, rating <span class="keyword">as</span> rating2 <span class="keyword">WHERE</span> rating.mID=movie.mID <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.rID=rating2.rID <span class="keyword">and</span> rating.mID = rating2.mID <span class="keyword">and</span> rating.stars&lt;rating2.stars <span class="keyword">and</span> rating.ratingDate&lt;rating2.ratingDate;</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title , MAX(stars) <span class="keyword">From</span> movie,rating <span class="keyword">WHERE</span> movie.mID=rating.mID <span class="keyword">GROUP</span> <span class="keyword">BY</span> movie.mID <span class="keyword">Order</span> <span class="keyword">by</span> movie.title;</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title, AVG (stars) <span class="keyword">from</span> movie, rating <span class="keyword">WHERE</span> movie.mID = rating.mID <span class="keyword">GROUP</span> <span class="keyword">BY</span> title <span class="keyword">ORDER</span> <span class="keyword">BY</span> AVG (stars) <span class="keyword">DESC</span>, title <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">9.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span> <span class="keyword">From</span> ((<span class="keyword">SELECT</span> reviewer.name, count(rating.mID) <span class="keyword">From</span> reviewer, rating <span class="keyword">Where</span> reviewer.rID = rating.rID <span class="keyword">Group</span> <span class="keyword">by</span> reviewer.rID <span class="keyword">Having</span> count(rating.mID) &gt; <span class="number">2</span>) <span class="keyword">as</span> r);</span><br><span class="line"><span class="number">9.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span> <span class="keyword">From</span> rating <span class="keyword">as</span> r1, rating <span class="keyword">as</span> r2, rating <span class="keyword">as</span> r3, reviewer <span class="keyword">where</span> reviewer.rID=r1.rID <span class="keyword">and</span> r1.rID = r2.rID <span class="keyword">and</span> r2.rID = r3.rID <span class="keyword">and</span> (r1.mID &lt;&gt; r2.mID <span class="keyword">or</span> r1.ratingDate&lt;&gt;r2.ratingDate) <span class="keyword">and</span> (r2.mID&lt;&gt;r3.mID <span class="keyword">or</span> r2.ratingDate&lt;&gt;r3.ratingDate) <span class="keyword">and</span> (r1.mID&lt;&gt; r3.mID <span class="keyword">or</span> r1.ratingDate&lt;&gt;r3.ratingDate);</span><br><span class="line"></span><br><span class="line"><span class="number">10.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span> <span class="keyword">From</span> movie, reviewer, rating <span class="keyword">Where</span> movie.mID=rating.mID <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> movie.title=<span class="string">&#x27;Gone with the Wind&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">11.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span>, stars, title <span class="keyword">From</span> movie, reviewer, rating <span class="keyword">Where</span> reviewer.name=movie.director <span class="keyword">AND</span> movie.mID=rating.mID <span class="keyword">and</span> reviewer.rID=rating.rID;</span><br><span class="line"></span><br><span class="line"><span class="number">12.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span> <span class="keyword">From</span> (<span class="keyword">SELECT</span> <span class="type">name</span> <span class="keyword">From</span> reviewer <span class="keyword">Union</span> <span class="keyword">SELECT</span> title <span class="keyword">as</span> <span class="type">name</span> <span class="keyword">From</span> movie) <span class="keyword">as</span> a <span class="keyword">Order</span> <span class="keyword">by</span> <span class="type">name</span></span><br><span class="line"></span><br><span class="line"><span class="number">13.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> M.title <span class="keyword">from</span> movie M, rating R <span class="keyword">where</span> M.mID = R.mID <span class="keyword">and</span> M.title <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> movie.title <span class="keyword">from</span> movie,reviewer,rating <span class="keyword">where</span> movie.mID= rating.mID <span class="keyword">and</span> reviewer.rID = rating.rID <span class="keyword">and</span> <span class="type">name</span> =<span class="string">&#x27;Chris Jackson&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">14.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> re1.name, re2.name <span class="keyword">FROM</span> rating r1, rating r2, reviewer re1, reviewer re2 <span class="keyword">WHERE</span> r1.rID != r2.rID <span class="keyword">AND</span> r1.mID = r2.mID <span class="keyword">AND</span> re1.rID = r1.rID <span class="keyword">AND</span> re2.rID = r2.rID <span class="keyword">AND</span> re1.name &lt; re2.name;</span><br><span class="line"></span><br><span class="line"><span class="number">15.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="type">name</span>,title,stars <span class="keyword">FROM</span> reviewer,movie,rating <span class="keyword">WHERE</span> stars <span class="keyword">in</span> (<span class="keyword">SELECT</span> min(stars) <span class="keyword">From</span> rating) <span class="keyword">AND</span> reviewer.rid = rating.rid <span class="keyword">and</span> movie.mid= rating.mid;</span><br><span class="line"></span><br><span class="line"><span class="number">16.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> R.rID, R.name <span class="keyword">FROM</span> reviewer R <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> mID <span class="keyword">FROM</span> movie <span class="keyword">WHERE</span> mID <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> mID <span class="keyword">FROM</span> rating <span class="keyword">WHERE</span> rID = R.rID));</span><br><span class="line">(mysql does <span class="keyword">not</span> support <span class="keyword">except</span>)<span class="keyword">SELECT</span> R.rID, R.name <span class="keyword">FROM</span> reviewer R <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> mID <span class="keyword">FROM</span> movie <span class="keyword">EXCEPT</span>(<span class="keyword">SELECT</span> mID <span class="keyword">FROM</span> reviewer, rating <span class="keyword">WHERE</span> reviewer.rID = rating.rID));</span><br><span class="line"></span><br><span class="line"><span class="number">17.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> M.* <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.mID = R.mID <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> <span class="type">name</span> =<span class="string">&#x27;Sarah Martinez&#x27;</span> <span class="keyword">and</span> title <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> title <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.mID = R.mID <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> <span class="type">name</span> =<span class="string">&#x27;Chris Jackson&#x27;</span>)</span><br><span class="line">(mysql does <span class="keyword">not</span> support <span class="keyword">except</span>)(<span class="keyword">SELECT</span> M.* <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.mID = R.mID <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> <span class="type">name</span> =<span class="string">&#x27;Tom&#x27;</span>) <span class="keyword">EXCEPT</span> (<span class="keyword">SELECT</span> * <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.mID = R.mID <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> <span class="type">name</span> =<span class="string">&#x27;Jerry&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">18.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">From</span> reviewer, rating, movie, rating <span class="keyword">as</span> rating1 <span class="keyword">WHERE</span> movie.mID=rating.mID <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.rID!=rating1.rID <span class="keyword">and</span> rating.mID = rating1.mID;</span><br><span class="line"></span><br><span class="line"><span class="number">19.</span><span class="keyword">SELECT</span> * <span class="keyword">from</span> movie M <span class="keyword">where</span> M.mID <span class="keyword">in</span> (<span class="keyword">SELECT</span> R.mID <span class="keyword">from</span> rating R <span class="keyword">GROUP</span> <span class="keyword">BY</span> R.mID <span class="keyword">having</span> count(rID) &gt;= <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">20.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> reviewer.name <span class="keyword">From</span> reviewer <span class="keyword">where</span> reviewer.name <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer,rating <span class="keyword">Where</span> reviewer.rID=rating.rID);</span><br><span class="line">(mysql does <span class="keyword">not</span> support <span class="keyword">except</span>)<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer <span class="keyword">Except</span> (<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer,rating <span class="keyword">Where</span> reviewer.rID=rating.rID);</span><br></pre></td></tr></table></figure>

<hr>
<p><em>参考博客和文章书籍等：</em></p>
<blockquote>
<p>stanford-sql课件第二章英文版</p>
</blockquote>
<p><em>因博客主等未标明不可引用，若部分内容涉及侵权请及时告知，我会尽快修改和删除相关内容</em></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Lys
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://linyishui.top/2019090601.html" title="stanford公开课sql基础题">http://linyishui.top/2019090601.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/sql/" rel="tag"><i class="fa fa-tag"></i> sql</a>
              <a href="/tags/database/" rel="tag"><i class="fa fa-tag"></i> database</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019090501.html" rel="prev" title="Git <整>">
                  <i class="fa fa-chevron-left"></i> Git <整>
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019090701.html" rel="next" title="A successful Git branching model-抠脚翻译">
                  A successful Git branching model-抠脚翻译 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lys</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">3.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">54:03</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>



  <script class="next-config" data-name="nprogress" type="application/json">{"enable":true,"spinner":true}</script>
  <script src="/js/third-party/nprogress.js"></script>

  




<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"LAILAIWA/LAILAIWA.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>



</body>
</html>
