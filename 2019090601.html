<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/gamepad playstation.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/Dig Dug.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/gamepad playstation.png?v=5.1.4">


  <link rel="mask-icon" href="/images/gamepad playstation.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="sql,database,">





  <link rel="alternate" href="/atom.xml" title="俺的部落格" type="application/atom+xml">






<meta name="description" content="stanford公开课sql基础题">
<meta name="keywords" content="sql,database">
<meta property="og:type" content="article">
<meta property="og:title" content="stanford公开课sql基础题">
<meta property="og:url" content="http://linyishui.top/2019090601.html">
<meta property="og:site_name" content="俺的部落格">
<meta property="og:description" content="stanford公开课sql基础题">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-10-28T12:12:44.357Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="stanford公开课sql基础题">
<meta name="twitter:description" content="stanford公开课sql基础题">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://linyishui.top/2019090601.html">





  <title>stanford公开课sql基础题 | 俺的部落格</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '[object Object]', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">俺的部落格</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">俺寻思俺需要记点东西</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://linyishui.top/2019090601.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="林沂水">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/riho_yoshioka1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="俺的部落格">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">stanford公开课sql基础题</h1>
        

        <div class="post-meta">
          
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-06T15:28:55+08:00">
                2019-09-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文档/" itemprop="url" rel="index">
                    <span itemprop="name">技术文档</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,556
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  21
                </span>
              
            </div>
          

          
              <div class="post-description">
                  stanford公开课sql基础题
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="sql基础题"><a href="#sql基础题" class="headerlink" title="sql基础题"></a><strong>sql基础题</strong></h1><h2 id="一、课件题目"><a href="#一、课件题目" class="headerlink" title="一、课件题目"></a><strong>一、课件题目</strong></h2><p>&emsp;&emsp;Suppose you’ve started a new movie-rating website, and you’ve been collecting data on reviewers’ ratings of various movies. There’s not much data yet, but you can still try out some interesting queries. Here’s the schema:  </p>
<p>&emsp;&emsp;Movie ( <u>mID</u>, title, year, director )  There is a movie with ID number mID, a title, a release year, and a director.  </p>
<p>&emsp;&emsp;Reviewer ( <u>rID</u>, name )  The reviewer with ID number rID has a certain name.  </p>
<p>&emsp;&emsp;Rating ( <u>rID</u>, <u>mID</u>, stars, ratingDate ) [rID, mID are foreign keys] The reviewer rID gave the movie mID a number of stars rating (1-5) on a certain ratingDate. </p>
<p>&emsp;&emsp;Write SQL statements to answer the following questions: </p>
<ol>
<li>Find the titles of all movies directed by Steven Spielberg.  </li>
<li>Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order of rating.  </li>
<li>Find the titles of all movies that have no ratings.  </li>
<li>Some reviewers didn’t provide a date with their rating. Find the names of all reviewers who have ratings with a NULL value for the date.  </li>
<li>Write a query to return the ratings data in a more readable format: reviewer name, movie title, stars, and ratingDate. </li>
<li>For all cases where the same reviewer rated the same movie twice and gave it a higher rating the second time, return the reviewer’s name and the title of the movie.  </li>
<li>For each movie that has at least one rating, find the highest number of stars that movie received. Return the movie title and number of stars. Sort by movie title. (hint: use GROUP BY)  </li>
<li>List movie titles and average ratings, from highest-rated to lowest-rated. If two or more movies have the same average rating, list them in alphabetical order.  </li>
<li>Find the names of all reviewers who have contributed three or more ratings.  </li>
<li>Find the names of all reviewers who rated Gone with the Wind. </li>
<li>For any rating where the reviewer is the same as the director of the movie, return the reviewer name, movie title, and number of stars. </li>
<li>Return all reviewer names and movie names together in a single column, alphabetized. (Sorting by the first name of the reviewer and first word in the title is fine; no need for special processing on last names or removing “The”.) </li>
<li>Find the titles of all movies not reviewed by Chris Jackson. </li>
<li>For all pairs of reviewers such that both reviewers gave a rating to the same movie, return the names of both reviewers. Eliminate duplicates, don’t pair reviewers with themselves, and include each pair only once. For each pair, return the names in the pair in alphabetical order. </li>
<li>For each rating that is the lowest (fewest stars) in the database, return the reviewer name, movie title, and number of stars of such ratings. </li>
<li>Find the reviewer who reviewed all movies. </li>
<li>Find the movies reviewed by Sarah Martinez and not reviewed by Chris Jackson. (hint: use NOT IN) </li>
<li>Find the movies that have been reviewed by at least two reviewers. Please write an SQL with only one SELECT and without GROUP BY. </li>
<li>Find the movies that have been reviewed by at least two reviewers. Please write an SQL with subquery. </li>
<li>Find the reviewers who do not review any movie. </li>
</ol>
<p>&emsp;&emsp;Note: When you use XAMPP+MySQL to check the correctness of your solution, please be noted that EXCEPT is not supported in MySQL.</p>
<h2 id="二、建表、数据"><a href="#二、建表、数据" class="headerlink" title="二、建表、数据"></a><strong>二、建表、数据</strong></h2><p>&emsp;&emsp;基于SqlServer。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建数据库</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> standford;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> standford;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> movie(</span><br><span class="line">    <span class="keyword">mid</span> <span class="built_in">int</span> primary <span class="keyword">key</span> ,</span><br><span class="line">    title <span class="built_in">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    <span class="keyword">year</span> <span class="built_in">int</span>,</span><br><span class="line">    director <span class="built_in">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> reviewer(</span><br><span class="line">    rid <span class="built_in">int</span> primary <span class="keyword">key</span> ,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> rating(</span><br><span class="line">    <span class="keyword">mid</span> <span class="built_in">int</span>,</span><br><span class="line">    rid <span class="built_in">int</span>,</span><br><span class="line">    stars <span class="built_in">int</span>,</span><br><span class="line">    ratingDate <span class="built_in">date</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--外键约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> rating </span><br><span class="line">  <span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_rating_movie_mid FOREIGN <span class="keyword">KEY</span> (<span class="keyword">mid</span>) <span class="keyword">references</span> movie(<span class="keyword">mid</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> rating </span><br><span class="line">  <span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_rating_reviewer_rid FOREIGN <span class="keyword">KEY</span> (rid) <span class="keyword">references</span> reviewer(rid);</span><br><span class="line"></span><br><span class="line"><span class="comment">--填充数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">101</span>,<span class="string">'Gone with the Wind'</span>,<span class="number">1939</span>,<span class="string">'Victor Fleming'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">102</span>,<span class="string">'Star Wars'</span>,<span class="number">1977</span>,<span class="string">'George Lucas'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">103</span>,<span class="string">'The Sound of Music'</span>,<span class="number">1965</span>,<span class="string">'Robert Wise'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">104</span>,<span class="string">'E.T.'</span>,<span class="number">1982</span>,<span class="string">'Steven Spielberg'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">105</span>,<span class="string">'Titanic'</span>,<span class="number">1997</span>,<span class="string">'James Cameron'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">106</span>,<span class="string">'Snow White'</span>,<span class="number">1937</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">107</span>,<span class="string">'Avatar'</span>,<span class="number">2009</span>,<span class="string">'James Cameron'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie(<span class="keyword">mid</span>,title,<span class="keyword">year</span>,director) <span class="keyword">values</span> (<span class="number">108</span>,<span class="string">'Raiders of the Lost Ark'</span>,<span class="number">1981</span>,<span class="string">'Steven Spielberg'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">201</span>,<span class="string">'Sarah Martinez'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">202</span>,<span class="string">'Daniel Lewis'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">203</span>,<span class="string">'Brittany Harris'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">204</span>,<span class="string">'Mike Anderson'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">205</span>,<span class="string">'Chris Jackson'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">206</span>,<span class="string">'Elizabeth Thomas'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">207</span>,<span class="string">'James Cameron'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> reviewer(rid,<span class="keyword">name</span>) <span class="keyword">values</span> (<span class="number">208</span>,<span class="string">'Ashley White'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">201</span>,<span class="number">101</span>,<span class="number">2</span>,<span class="string">'2011-01-22'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">201</span>,<span class="number">101</span>,<span class="number">4</span>,<span class="string">'2011-01-27'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">202</span>,<span class="number">106</span>,<span class="number">4</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">103</span>,<span class="number">2</span>,<span class="string">'2011-01-20'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">108</span>,<span class="number">4</span>,<span class="string">'2011-01-12'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">203</span>,<span class="number">108</span>,<span class="number">2</span>,<span class="string">'2011-01-30'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">204</span>,<span class="number">101</span>,<span class="number">3</span>,<span class="string">'2011-01-09'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">103</span>,<span class="number">3</span>,<span class="string">'2011-01-27'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">104</span>,<span class="number">2</span>,<span class="string">'2011-01-22'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">205</span>,<span class="number">108</span>,<span class="number">4</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">206</span>,<span class="number">107</span>,<span class="number">3</span>,<span class="string">'2011-01-15'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">206</span>,<span class="number">106</span>,<span class="number">5</span>,<span class="string">'2011-01-19'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">207</span>,<span class="number">107</span>,<span class="number">5</span>,<span class="string">'2011-01-20'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> rating(rid,<span class="keyword">mid</span>,stars,ratingDate) <span class="keyword">values</span> (<span class="number">208</span>,<span class="number">104</span>,<span class="number">3</span>,<span class="string">'2011-01-02'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="三、作答"><a href="#三、作答" class="headerlink" title="三、作答"></a><strong>三、作答</strong></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--1. Find the titles of all movies directed by Steven Spielberg.  </span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> director = <span class="string">'Steven Spielberg'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2. Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order of rating.  </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span></span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">max</span>(stars) <span class="keyword">as</span> maxStars,<span class="keyword">mid</span> <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span> </span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> movie.mid = rating.mid</span><br><span class="line">			   <span class="keyword">and</span> rating.stars <span class="keyword">in</span> (<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> (<span class="keyword">select</span> <span class="keyword">max</span>(stars) <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>),<span class="keyword">year</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--对应</span></span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> rating</span><br><span class="line"><span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">max</span>(stars) <span class="keyword">as</span> maxStars,<span class="keyword">mid</span> <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> rating.stars <span class="keyword">in</span> (<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> maxStars,<span class="keyword">year</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--3. Find the titles of all movies that have no ratings.  </span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> movie.mid = rating.mid);</span><br><span class="line"></span><br><span class="line"><span class="comment">--4. Some reviewers didn't provide a date with their rating. Find the names of all reviewers who have ratings with a NULL value for the date.  </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> reviewer.rid = rating.rid</span><br><span class="line">			   <span class="keyword">and</span> ratingDate <span class="keyword">is</span> <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--5. Write a query to return the ratings data in a more readable format: reviewer name, movie title, stars, and ratingDate. </span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,</span><br><span class="line">	   rating.stars,</span><br><span class="line">	   rating.ratingDate</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid;</span><br><span class="line"></span><br><span class="line"><span class="comment">--6. For all cases where the same reviewer rated the same movie twice and gave it a higher rating the second time, return the reviewer's name and the title of the movie.  </span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,ratingDate,stars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">max</span>(ratingDate) <span class="keyword">as</span> maxDate,<span class="keyword">max</span>(stars) <span class="keyword">as</span> maxStars,<span class="keyword">mid</span>,rid</span><br><span class="line">           <span class="keyword">from</span> rating</span><br><span class="line">		   <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>,rid) maxSelect</span><br><span class="line"><span class="keyword">on</span> rating.rid = maxSelect.rid <span class="keyword">and</span> rating.mid = maxSelect.mid</span><br><span class="line"><span class="keyword">where</span> rating.ratingDate = maxDate <span class="keyword">and</span> rating.stars = maxStars</span><br><span class="line">  <span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating r</span><br><span class="line">	         <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>,rid</span><br><span class="line">	         <span class="keyword">having</span> rating.rid = r.rid</span><br><span class="line">	            <span class="keyword">and</span> rating.mid = r.mid</span><br><span class="line">	            <span class="keyword">and</span> <span class="keyword">count</span>(*) = <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--7. For each movie that has at least one rating, find the highest number of stars that movie received. Return the movie title and number of stars. Sort by movie title. (hint: use GROUP BY)  </span></span><br><span class="line"><span class="keyword">select</span> movie.title,maxStars</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">max</span>(stars) <span class="keyword">as</span> maxStars,<span class="keyword">mid</span> <span class="keyword">from</span> rating <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span>) maxRating</span><br><span class="line"><span class="keyword">on</span> movie.mid = maxRating.mid</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">mid</span> <span class="keyword">having</span> <span class="keyword">count</span>(*) &gt; <span class="number">0</span>)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> movie.title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--8. List movie titles and average ratings, from highest-rated to lowest-rated. If two or more movies have the same average rating, list them in alphabetical order.  </span></span><br><span class="line"><span class="keyword">select</span> movie.title,<span class="keyword">AVG</span>(stars) <span class="keyword">as</span> avgStars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> movie.mid,movie.title</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">AVG</span>(stars) <span class="keyword">desc</span>,movie.title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--9. Find the names of all reviewers who have contributed three or more ratings.  </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">where</span> rating.rid = reviewer.rid</span><br><span class="line">	         <span class="keyword">group</span> <span class="keyword">by</span> rid</span><br><span class="line">			 <span class="keyword">having</span> <span class="keyword">count</span>(*) &gt; <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--10. Find the names of all reviewers who rated Gone with the Wind. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> rating.mid = movie.mid</span><br><span class="line">			 <span class="keyword">where</span> rating.rid = reviewer.rid</span><br><span class="line">	           <span class="keyword">and</span> title = <span class="string">'Gone with the Wind'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--11. For any rating where the reviewer is the same as the director of the movie, return the reviewer name, movie title, and number of stars. </span></span><br><span class="line"><span class="comment">--查询导演作为评论人的电影，返回评论人名和电影名</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">where</span> reviewer.name = movie.director;</span><br><span class="line"></span><br><span class="line"><span class="comment">--12. Return all reviewer names and movie names together in a single column, alphabetized. (Sorting by the first name of the reviewer and first word in the title is fine; no need for special processing on last names or removing "The".) </span></span><br><span class="line"><span class="comment">--把所有评论人名和电影名放入一列返回，按评论人名和标题名首字母排序，不需要对姓氏进行特殊处理或删除“the”</span></span><br><span class="line"><span class="keyword">select</span> title <span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> title;</span><br><span class="line"></span><br><span class="line"><span class="comment">--13. Find the titles of all movies not reviewed by Chris Jackson. </span></span><br><span class="line"><span class="comment">--查询所有未受Chris Jackson评论的电影名</span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">			 <span class="keyword">left</span> <span class="keyword">join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line">			 <span class="keyword">where</span> rating.mid = movie.mid</span><br><span class="line">	           <span class="keyword">and</span> <span class="keyword">name</span> = <span class="string">'Chris Jackson'</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">--14. For all pairs of reviewers such that both reviewers gave a rating to the same movie, return the names of both reviewers. Eliminate duplicates, don't pair reviewers with themselves, and include each pair only once. For each pair, return the names in the pair in alphabetical order. </span></span><br><span class="line"><span class="comment">--当有两个评论人给同个电影评论时返回两个评论人名，删除重复项，按姓名排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> reviewer1.name &lt;= reviewer2.name <span class="keyword">then</span> reviewer1.name <span class="keyword">else</span> reviewer2.name <span class="keyword">end</span> a, <span class="comment">--去除顺序相关</span></span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> reviewer1.name &lt;= reviewer2.name <span class="keyword">then</span> reviewer2.name <span class="keyword">else</span> reviewer1.name <span class="keyword">end</span> b</span><br><span class="line">            <span class="keyword">from</span> rating r1</span><br><span class="line">            <span class="keyword">join</span> reviewer reviewer1 <span class="keyword">on</span> r1.rid = reviewer1.rid</span><br><span class="line">			<span class="keyword">join</span> rating r2 <span class="keyword">on</span> r1.mid = r2.mid <span class="keyword">and</span> r1.rid != r2.rid <span class="comment">--配对</span></span><br><span class="line">			<span class="keyword">join</span> reviewer reviewer2 <span class="keyword">on</span> r2.rid = reviewer2.rid) m</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a,b <span class="comment">--分组去重</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a,b; <span class="comment">--按姓名排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--顺序相关去重 select * from tb1 group by A, B having count(*) &gt;0;</span></span><br><span class="line"><span class="comment">--顺序不相关去重 select aa,bb from (select case when a&lt;=b then a else b end aa,case when a&lt;=b then b else a end bb from tbl) tt group by aa,bb;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--15. For each rating that is the lowest (fewest stars) in the database, return the reviewer name, movie title, and number of stars of such ratings. </span></span><br><span class="line"><span class="comment">--查询库中的最低评分，返回评论人名，电影名和评分</span></span><br><span class="line"><span class="keyword">select</span> reviewer.name <span class="keyword">as</span> reviewerName,</span><br><span class="line">       movie.title <span class="keyword">as</span> movieTitle,</span><br><span class="line">	   stars</span><br><span class="line"><span class="keyword">from</span> rating</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> movie <span class="keyword">on</span> movie.mid = rating.mid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> reviewer <span class="keyword">on</span> reviewer.rid = rating.rid</span><br><span class="line"><span class="keyword">where</span> rating.stars = (<span class="keyword">select</span> <span class="keyword">min</span>(stars) <span class="keyword">from</span> rating);</span><br><span class="line"></span><br><span class="line"><span class="comment">--16. Find the reviewer who reviewed all movies. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*)</span><br><span class="line">       <span class="keyword">from</span> (<span class="keyword">SELECT</span> <span class="keyword">distinct</span> rid,<span class="keyword">mid</span></span><br><span class="line">             <span class="keyword">from</span> rating</span><br><span class="line">             <span class="keyword">where</span> reviewer.rid = rating.rid ) a ) <span class="comment">--统计当前用户观看电影数</span></span><br><span class="line">      = (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> movie); <span class="comment">--统计电影总数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--17. Find the movies reviewed by Sarah Martinez and not reviewed by Chris Jackson. (hint: use NOT IN) </span></span><br><span class="line"><span class="comment">--查询Sarah Martinez有评论而Chris Jackson未评论的电影</span></span><br><span class="line"><span class="keyword">select</span> title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">mid</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">mid</span> <span class="keyword">from</span> rating,reviewer <span class="keyword">where</span> rating.rid = reviewer.rid <span class="keyword">and</span> reviewer.name = <span class="string">'Sarah Martinez'</span>)</span><br><span class="line">  <span class="keyword">and</span> <span class="keyword">mid</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">mid</span> <span class="keyword">from</span> rating,reviewer <span class="keyword">where</span> rating.rid = reviewer.rid <span class="keyword">and</span> reviewer.name = <span class="string">'Chris Jackson'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--18. Find the movies that have been reviewed by at least two reviewers. Please write an SQL with only one SELECT and without GROUP BY. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> a.mid</span><br><span class="line"><span class="keyword">from</span> rating <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">join</span> rating <span class="keyword">as</span> b </span><br><span class="line"><span class="keyword">on</span> a.mid = b.mid </span><br><span class="line"><span class="keyword">and</span> a.rid != b.rid;</span><br><span class="line"></span><br><span class="line"><span class="comment">--19. Find the movies that have been reviewed by at least two reviewers. Please write an SQL with subquery. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">mid</span>,title</span><br><span class="line"><span class="keyword">from</span> movie</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> rating <span class="keyword">where</span> movie.mid = rating.mid) &gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--20. Find the reviewers who do not review any movie. </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">from</span> reviewer</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> rating <span class="keyword">where</span> reviewer.rid = rating.rid) = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h2 id="四、答案"><a href="#四、答案" class="headerlink" title="四、答案"></a><strong>四、答案</strong></h2><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">FROM</span> movie <span class="keyword">Where</span> director=<span class="comment">'Steven Spielberg';</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Year,stars <span class="keyword">From</span> movie, rating <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span>=rating.<span class="keyword">mID</span> <span class="keyword">and</span> (rating.stars = <span class="number">4</span> <span class="keyword">OR</span> rating.stars= <span class="number">5</span>) <span class="keyword">ORDER</span> <span class="keyword">BY</span> rating.stars ASC;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">from</span> movie <span class="keyword">where</span> <span class="keyword">mID</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> <span class="keyword">mID</span> <span class="keyword">from</span> rating )</span><br><span class="line">(mysql does <span class="keyword">not</span> support except)(<span class="keyword">SELECT</span> title <span class="keyword">FROM</span> movie) EXCEPT (<span class="keyword">SELECT</span> title <span class="keyword">FROM</span> movie, rating  <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span> = rating.<span class="keyword">mID</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Name <span class="keyword">FROM</span> reviewer, rating <span class="keyword">WHERE</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.ratingDate <span class="keyword">is</span> null;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name, title, stars, ratingDate <span class="keyword">FROM</span> movie, rating, reviewer <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span> = rating.<span class="keyword">mID</span> <span class="keyword">AND</span> reviewer.rID = rating.rID;</span><br><span class="line"><span class="number">5.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name, title, stars, ratingDate <span class="keyword">FROM</span> movie <span class="keyword">join</span> rating <span class="keyword">join</span> reviewer <span class="keyword">ON</span> movie.<span class="keyword">mID</span> = rating.<span class="keyword">mID</span> <span class="keyword">AND</span> reviewer.rID = rating.rID;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name, title <span class="keyword">From</span> movie , reviewer, rating, rating <span class="keyword">as</span> rating2 <span class="keyword">WHERE</span> rating.<span class="keyword">mID</span>=movie.<span class="keyword">mID</span> <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.rID=rating2.rID <span class="keyword">and</span> rating.<span class="keyword">mID</span> = rating2.<span class="keyword">mID</span> <span class="keyword">and</span> rating.stars&lt;rating2.stars <span class="keyword">and</span> rating.ratingDate&lt;rating2.ratingDate;</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title , MAX(stars) <span class="keyword">From</span> movie,rating <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span>=rating.<span class="keyword">mID</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> movie.<span class="keyword">mID</span> <span class="keyword">Order</span> <span class="keyword">by</span> movie.title;</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title, AVG (stars) <span class="keyword">from</span> movie, rating <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span> = rating.<span class="keyword">mID</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> title <span class="keyword">ORDER</span> <span class="keyword">BY</span> AVG (stars) DESC, title ASC;</span><br><span class="line"></span><br><span class="line"><span class="number">9.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name <span class="keyword">From</span> ((<span class="keyword">SELECT</span> reviewer.name, count(rating.<span class="keyword">mID</span>) <span class="keyword">From</span> reviewer, rating <span class="keyword">Where</span> reviewer.rID = rating.rID <span class="keyword">Group</span> <span class="keyword">by</span> reviewer.rID Having count(rating.<span class="keyword">mID</span>) &gt; <span class="number">2</span>) <span class="keyword">as</span> r);</span><br><span class="line"><span class="number">9.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name <span class="keyword">From</span> rating <span class="keyword">as</span> r1, rating <span class="keyword">as</span> r2, rating <span class="keyword">as</span> r3, reviewer <span class="keyword">where</span> reviewer.rID=r1.rID <span class="keyword">and</span> r1.rID = r2.rID <span class="keyword">and</span> r2.rID = r3.rID <span class="keyword">and</span> (r1.<span class="keyword">mID</span> &lt;&gt; r2.<span class="keyword">mID</span> <span class="keyword">or</span> r1.ratingDate&lt;&gt;r2.ratingDate) <span class="keyword">and</span> (r2.<span class="keyword">mID</span>&lt;&gt;r3.<span class="keyword">mID</span> <span class="keyword">or</span> r2.ratingDate&lt;&gt;r3.ratingDate) <span class="keyword">and</span> (r1.<span class="keyword">mID</span>&lt;&gt; r3.<span class="keyword">mID</span> <span class="keyword">or</span> r1.ratingDate&lt;&gt;r3.ratingDate);</span><br><span class="line"></span><br><span class="line"><span class="number">10.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name <span class="keyword">From</span> movie, reviewer, rating <span class="keyword">Where</span> movie.<span class="keyword">mID</span>=rating.<span class="keyword">mID</span> <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> movie.title=<span class="comment">'Gone with the Wind';</span></span><br><span class="line"></span><br><span class="line"><span class="number">11.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name, stars, title <span class="keyword">From</span> movie, reviewer, rating <span class="keyword">Where</span> reviewer.name=movie.director <span class="keyword">AND</span> movie.<span class="keyword">mID</span>=rating.<span class="keyword">mID</span> <span class="keyword">and</span> reviewer.rID=rating.rID;</span><br><span class="line"></span><br><span class="line"><span class="number">12.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name <span class="keyword">From</span> (<span class="keyword">SELECT</span> name <span class="keyword">From</span> reviewer Union <span class="keyword">SELECT</span> title <span class="keyword">as</span> name <span class="keyword">From</span> movie) <span class="keyword">as</span> a <span class="keyword">Order</span> <span class="keyword">by</span> name</span><br><span class="line"></span><br><span class="line"><span class="number">13.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> M.title <span class="keyword">from</span> movie M, rating R <span class="keyword">where</span> M.<span class="keyword">mID</span> = R.<span class="keyword">mID</span> <span class="keyword">and</span> M.title <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> movie.title <span class="keyword">from</span> movie,reviewer,rating <span class="keyword">where</span> movie.<span class="keyword">mID</span>= rating.<span class="keyword">mID</span> <span class="keyword">and</span> reviewer.rID = rating.rID <span class="keyword">and</span> name =<span class="comment">'Chris Jackson')</span></span><br><span class="line"></span><br><span class="line"><span class="number">14.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> re1.name, re2.name <span class="keyword">FROM</span> rating r1, rating r2, reviewer re1, reviewer re2 <span class="keyword">WHERE</span> r1.rID != r2.rID <span class="keyword">AND</span> r1.<span class="keyword">mID</span> = r2.<span class="keyword">mID</span> <span class="keyword">AND</span> re1.rID = r1.rID <span class="keyword">AND</span> re2.rID = r2.rID <span class="keyword">AND</span> re1.name &lt; re2.name;</span><br><span class="line"></span><br><span class="line"><span class="number">15.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name,title,stars <span class="keyword">FROM</span> reviewer,movie,rating <span class="keyword">WHERE</span> stars <span class="keyword">in</span> (<span class="keyword">SELECT</span> min(stars) <span class="keyword">From</span> rating) <span class="keyword">AND</span> reviewer.rid = rating.rid <span class="keyword">and</span> movie.<span class="keyword">mid</span>= rating.<span class="keyword">mid</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">16.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> R.rID, R.name <span class="keyword">FROM</span> reviewer R <span class="keyword">WHERE</span> <span class="keyword">NOT</span> EXISTS (<span class="keyword">SELECT</span> <span class="keyword">mID</span> <span class="keyword">FROM</span> movie <span class="keyword">WHERE</span> <span class="keyword">mID</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> <span class="keyword">mID</span> <span class="keyword">FROM</span> rating <span class="keyword">WHERE</span> rID = R.rID));</span><br><span class="line">(mysql does <span class="keyword">not</span> support except)<span class="keyword">SELECT</span> R.rID, R.name <span class="keyword">FROM</span> reviewer R <span class="keyword">WHERE</span> <span class="keyword">NOT</span> EXISTS (<span class="keyword">SELECT</span> <span class="keyword">mID</span> <span class="keyword">FROM</span> movie EXCEPT(<span class="keyword">SELECT</span> <span class="keyword">mID</span> <span class="keyword">FROM</span> reviewer, rating <span class="keyword">WHERE</span> reviewer.rID = rating.rID));</span><br><span class="line"></span><br><span class="line"><span class="number">17.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> M.* <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.<span class="keyword">mID</span> = R.<span class="keyword">mID</span> <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> name =<span class="comment">'Sarah Martinez' and title not in (SELECT title from movie M, rating R, reviewer V where M.mID = R.mID and V.rID = R.rID and name ='Chris Jackson')</span></span><br><span class="line">(mysql does <span class="keyword">not</span> support except)(<span class="keyword">SELECT</span> M.* <span class="keyword">from</span> movie M, rating R, reviewer V <span class="keyword">where</span> M.<span class="keyword">mID</span> = R.<span class="keyword">mID</span> <span class="keyword">and</span> V.rID = R.rID <span class="keyword">and</span> name =<span class="comment">'Tom') EXCEPT (SELECT * from movie M, rating R, reviewer V where M.mID = R.mID and V.rID = R.rID and name ='Jerry')</span></span><br><span class="line"></span><br><span class="line"><span class="number">18.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> title <span class="keyword">From</span> reviewer, rating, movie, rating <span class="keyword">as</span> rating1 <span class="keyword">WHERE</span> movie.<span class="keyword">mID</span>=rating.<span class="keyword">mID</span> <span class="keyword">and</span> reviewer.rID=rating.rID <span class="keyword">and</span> rating.rID!=rating1.rID <span class="keyword">and</span> rating.<span class="keyword">mID</span> = rating1.<span class="keyword">mID</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">19.</span><span class="keyword">SELECT</span> * <span class="keyword">from</span> movie M <span class="keyword">where</span> M.<span class="keyword">mID</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> R.<span class="keyword">mID</span> <span class="keyword">from</span> rating R <span class="keyword">GROUP</span> <span class="keyword">BY</span> R.<span class="keyword">mID</span> having count(rID) &gt;= <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">20.</span><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> reviewer.name <span class="keyword">From</span> reviewer <span class="keyword">where</span> reviewer.name <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer,rating <span class="keyword">Where</span> reviewer.rID=rating.rID);</span><br><span class="line">(mysql does <span class="keyword">not</span> support except)<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer Except (<span class="keyword">SELECT</span> reviewer.name <span class="keyword">From</span> reviewer,rating <span class="keyword">Where</span> reviewer.rID=rating.rID);</span><br></pre></td></tr></table></figure>
<hr>
<p><em>参考博客和文章书籍等：</em></p>
<blockquote>
<p>stanford-sql课件第二章英文版</p>
</blockquote>
<p><em>因博客主等未标明不可引用，若部分内容涉及侵权请及时告知，我会尽快修改和删除相关内容</em></p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    林沂水
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://linyishui.top/2019090601.html" title="stanford公开课sql基础题">http://linyishui.top/2019090601.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    
      <div>
         ﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      </div>
    
    
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/sql/" rel="tag"># sql</a>
          
            <a href="/tags/database/" rel="tag"># database</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019090501.html" rel="next" title="Git <整>">
                <i class="fa fa-chevron-left"></i> Git <整>
              </整></a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019090701.html" rel="prev" title="A successful Git branching model-抠脚翻译">
                A successful Git branching model-抠脚翻译 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
     <div class="comments" id="comments">
       

<script src="https://utteranc.es/client.js" repo="LAILAIWA/LAILAIWA.github.io" issue-term="pathname" label="💬Comments" theme="github-light" crossorigin="anonymous" async>
</script>



     </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://pic-1258215793.cos.ap-shanghai.myqcloud.com/cover/riho_yoshioka1.jpg" alt="林沂水">
            
              <p class="site-author-name" itemprop="name">林沂水</p>
              <p class="site-description motion-element" itemprop="description">记录编程点滴，写点生活中的酸甜</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">304</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">99</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/LAILAIWA" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:linyishui168@outlook.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/linyishui618" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/linyishui618" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/u/5340162234" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-weibo.com"></i>Weibo</a>
                  </span>
                
            </div>
          

          
          

          
          

          <div id="days"></div>
<script>
function show_date_time(){
    window.setTimeout("show_date_time()", 1000);
    BirthDay=new Date("07/26/2018 00:00:00");
    today=new Date();
    timeold=(today.getTime()-BirthDay.getTime());
    sectimeold=timeold/1000
    secondsold=Math.floor(sectimeold);
    msPerDay=24*60*60*1000
    e_daysold=timeold/msPerDay
    daysold=Math.floor(e_daysold);
    e_hrsold=(e_daysold-daysold)*24;
    hrsold=setzero(Math.floor(e_hrsold));
    e_minsold=(e_hrsold-hrsold)*60;
    minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
    seconds=setzero(Math.floor((e_minsold-minsold)*60));
    document.getElementById('days').innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
}
function setzero(i) {
    if (i<10) {
        i="0" + i
    };
    return i;
}
show_date_time();
</script>  
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#sql基础题"><span class="nav-number">1.</span> <span class="nav-text">sql基础题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、课件题目"><span class="nav-number">1.1.</span> <span class="nav-text">一、课件题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、建表、数据"><span class="nav-number">1.2.</span> <span class="nav-text">二、建表、数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、作答"><span class="nav-number">1.3.</span> <span class="nav-text">三、作答</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、答案"><span class="nav-number">1.4.</span> <span class="nav-text">四、答案</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        ﻿<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">林沂水</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
   

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
